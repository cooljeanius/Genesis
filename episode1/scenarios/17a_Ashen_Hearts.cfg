#textdomain wesnoth-Genesis

[scenario]
    id=17a_Ashen_Hearts
    name= _ "Ashen Hearts - I"
    map_data="{~add-ons/Genesis/episode1/maps/04e_The_White_City.map}"
    next_scenario=17b_Ashen_Hearts
    disallow_recall=yes
    victory_when_enemies_defeated=no
    theme=Cutscene
    turns=-1
    {DEFAULT_SCHEDULE_24H}

    {SCENARIO_MUSIC journeys_end.ogg}
    {STORYTXT_ASHEN_HEARTS}

    [side]
        {PLAYER_FAE}
        {NO_GOLD_SIDE}
        side=1
        recruit=
    [/side]

    [side]
        {HUMAN_ALLY}
        side=2
        no_leader=yes
    [/side]

    [side]
        side=3
        no_leader=yes
        team_name=fae
        color=white
        user_team_name= _ "team_name^Magi"
    [/side]

    [side]
        {HUMAN_ENEMY}
        side=4
        no_leader=yes
        hidden=yes
    [/side]

    [side]
        {HUMAN_ENEMY}
        side=5
        no_leader=yes
        hidden=yes
    [/side]

    [side]
        {YUURE_SIDE}
        side=6
        hidden=yes
    [/side]

    [event]
        name=prestart

        # for some reason my save has some random variables in it so I'm just clearing them here
        {CLEAR_VARIABLE to_kill}
        {CLEAR_VARIABLE heal_amount}

        [label]
            x,y=7,19
            text = _ "Colosseum"
        [/label]
        [label]
            x,y=36,20
            text = _ "Marketplace"
        [/label]
        [label]
            x,y=2,1
            text = _ "Upper District"
        [/label]
        [label]
            x,y=3,9
            text = _ "Temple"
        [/label]
        [label]
            x,y=38,2
            text = _ "Crypt"
        [/label]
        [label]
            x,y=18,2
            text = _ "Pantheon"
        [/label]
        [set_recruit]
            side=1
            recruit=
        [/set_recruit]

        [store_unit]
            [filter]
                id=Aryel
            [/filter]
            variable=aryel
        [/store_unit]
        [kill]
            id=Aryel
        [/kill]
        [store_unit]
            [filter]
                id=Esther
            [/filter]
            variable=esther
        [/store_unit]
        [kill]
            id=Esther
        [/kill]

        [unit]
            side=1
            id=Esther_Fake
            name= _ "Esther"
            type=Fire Fae Wingless
            random_traits=no
            animate=no
            x,y=21,40
            canrecruit=yes
            unrenamable=yes
        [/unit]
        [unit]
            side=1
            id=Aryel_Fake
            name= _ "Aryel"
            type=Blood Fae Wingless
            random_traits=no
            animate=no
            x,y=20,40
            canrecruit=yes
            unrenamable=yes
        [/unit]
        [set_variable]
            name=found_kid
            value=0
        [/set_variable]
        [set_variable]
            name=turn_count
            value=0
        [/set_variable]
        [set_variable]
            name=part1
            value=1
        [/set_variable]
        [set_variable]
            name=part2
            value=0
        [/set_variable]
        [set_variable]
            name=part3
            value=0
        [/set_variable]
    [/event]

    {SPAWN_POINT ("Royal Guard") 2 20 35}
    {SPAWN_POINT ("Royal Guard") 2 22 35}
    {SPAWN_POINT ("Master Bowman") 2 31 29}
    {SPAWN_POINT ("Master Bowman") 2 37 29}
    {SPAWN_POINT ("Master Bowman") 2 8 29}
    {SPAWN_POINT ("Master Bowman") 2 12 29}
    {SPAWN_POINT ("Master Bowman") 2 17 31}
    {SPAWN_POINT ("Master Bowman") 2 19 31}
    {SPAWN_POINT ("Master Bowman") 2 23 31}
    {SPAWN_POINT ("Master Bowman") 2 25 31}
    {SPAWN_POINT ("Master at Arms") 2 10 22}
    {SPAWN_POINT ("Peasant") 2 34 21}
    {SPAWN_POINT ("Peasant") 2 33 19}
    {SPAWN_POINT ("Peasant") 2 37 19}
    {SPAWN_POINT ("Royal Guard") 2 17 8}
    {SPAWN_POINT ("Royal Guard") 2 18 8}
    {SPAWN_POINT ("Royal Guard") 2 19 8}
    {SPAWN_POINT ("Royal Guard") 2 37 2}
    {SPAWN_POINT ("Royal Guard") 2 38 2}
    {SPAWN_POINT ("Royal Guard") 2 39 2}

    # magi spawn
    {SPAWN_POINT ("Mage") 3 30 20}
    {SPAWN_POINT ("Mage") 3 32 8}
    {SPAWN_POINT ("Mage") 3 20 17}
    {SPAWN_POINT ("Mage") 3 8 8}

    [event]
        name=start

        {RECALL_TALYA 22 40}
        [message]
            speaker=Esther_Fake
            message= _ "Nice work on the glamour, Aryel. Now they won't be able to see our wings."
        [/message]
        [message]
            speaker=Aryel_Fake
            message= _ "You'd hope so, but I'm not as good at this kind of thing as Yumi is. So some of the more magically adept humans might be able to see through it. Also, what about you, Talya?"
        [/message]
        [message]
            speaker=Talya
            message= _ "Me?"
        [/message]
        [message]
            speaker=Aryel_Fake
            message= _ "Won't they recognize you?"
        [/message]
        [message]
            speaker=Talya
            message= _ "Naw. See?"
        [/message]
        [message]
            speaker=Talya
            message= _ "(<i>puts on glasses</i>)"
        [/message]
        [message]
            speaker=Talya
            message= _ "Now they won't. Well, the people from the guild might. But we have to avoid them anyway."
        [/message]
        [message]
            speaker=Aryel_Fake
            message= _ "Right, because putting on a pair of glasses is the best disguise ever."
        [/message]
        [message]
            speaker=Talya
            message= _ "Hey, you know those stories about legendary ultra super heroes and stuff? They wear glasses as disguises and even their super smart nemesises can't figure out their secret identities. So if it works for them, it should work for me!"
        [/message]
        [message]
            speaker=Esther_Fake
            message= _ "Right. Anyway, remember the plan. We head straight for the Upper District and find Yumi. But we have to stay away from the mages, just in case they'll recognize us. From there, Talya and I will confront the magi, should they attempt to stop us. Aryel will go find Yumi."
        [/message]
        [message]
            speaker=Aryel_Fake
            message= _ "Esther, I know I'm injured, but I can fight-"
        [/message]
        [message]
            speaker=Esther_Fake
            message= _ "No, it's because you're the only one who can sense where she is exactly."
        [/message]
        [message]
            speaker=Aryel_Fake
            message= _ "Ah. Right. Of course. Well then, sounds good to me. Let's get going."
        [/message]

        [objectives]
            {OBJECTIVE_VICTORY  ( _ "Reach the Upper District")}
            {OBJECTIVE_DEFEAT  ( _ "Get caught by a mage")}
            {OBJECTIVE_NOTE ( _ "There are a few small bonuses that can be obtained on this map.")}
            {OBJECTIVE_NOTE ( _ "Magi only move to within 3 hexes of their current location.")}
        [/objectives]
    [/event]
# reach the gate
    [event]
        name=moveto
        [filter]
            x=19-23
            y=36
            id=Talya
        [/filter]
        [filter_condition]
            [variable]
                name=part1
                numerical_equals=1
            [/variable]
        [/filter_condition]
        [message]
            speaker=spawn_20_35
            message= _ "Halt! State your business."
        [/message]
        [message]
            speaker=Talya
            message= _ "Hey there, handsome. I live in the Upper District with my dad. Just bringing some friends with me to see the gardens. And the statues."
        [/message]
        [message]
            speaker=spawn_20_35
            message= _ "I-I see. What's your name, girl?"
        [/message]
        [message]
            speaker=Talya
            message= _ "I'm Tali! Miss Ginger over there's Ethiel, and Miss Gloomy here is Arya. Friends from my hometown."
        [/message]
        [message]
            speaker=Aryel_Fake
            message= _ "(<i>raises eyebrow</i>)"
        [/message]
        [message]
            speaker=Talya
            message= _ "(<i>shrugs</i>)"
        [/message]
        [message]
            speaker=spawn_20_35
            message= _ "Ah, I see. Well, you three seem like nice girls. Where is your home?"
        [/message]
        [message]
            speaker=Talya
            message= _ "Rostenham, to the east."
        [/message]
        [message]
            speaker=spawn_22_35
            message= _ "Right. And you expect us to believe that three weak, young girls like you would be traveling alone during a time like this? I'm sure you know about the faerie problem we're having."
        [/message]
        [message]
            speaker=Aryel_Fake
            message= _ "(<i>whispers</i>) Weak? We're not weak! Why, I'll show him-"
        [/message]
        [message]
            speaker=Talya
            message= _ "(<i>whispers</i>) Shush, you."
        [/message]
        [message]
            speaker=Talya
            message= _ "Of course we know about those dastardly faerie! My dad hired some men from our hometown to take care of us. They guarded us most of the way here, but wanted to get back to their families. I'm sure a nice guy like you could understand."
        [/message]
        [message]
            speaker=spawn_22_35
            message= _ "Actually, I don't have a family. And I'm not nice."
        [/message]
        [message]
            speaker=spawn_20_35
            message= _ "Come on, lighten up. She's just a young girl. They don't seem like the troublesome type, either."
        [/message]
        [message]
            speaker=spawn_22_35
            message= _ "We are guardsmen. We can't just let anyone in the city willy-nilly, or there would be no order."
        [/message]
        [message]
            speaker=spawn_20_35
            message= _ "Sure, but the girl lives here. And you said it yourself. They're tiny and weak. No way we couldn't subdue 'em if anything happened. Erm, not that I think you three ladies will go stirring up trouble. <small>Cute glasses, by the way.</small>"
        [/message]
        [message]
            speaker=Talya
            message= _ "<small>Ehehe, you like them?</small>"
        [/message]
        [message]
            speaker=spawn_22_35
            message= _ "Hmph. Fine, you can go in."
        [/message]
        [message]
            speaker=Talya
            message= _ "Thanks!"
        [/message]

        [move_unit]
            id=spawn_20_35
            to_x,to_y=19,36
        [/move_unit]
        [move_unit]
            id=spawn_22_35
            to_x,to_y=23,36
        [/move_unit]
        [terrain]
            x=20,22
            y=34,34
            terrain=Brym^Sy|
        [/terrain]
        [redraw][/redraw]
    [/event]

# mage movement
    [event]
        name=side 3 turn
        first_time_only=no
        [filter_condition]
            [variable]
                name=part1
                numerical_equals=1
            [/variable]
        [/filter_condition]
        [store_locations]
            variable=hex
            x=28-40
            y=18-23
            [and]
                [filter_adjacent_location]
                    [filter]
                        id=spawn_30_20
                    [/filter]
                    radius=2
                [/filter_adjacent_location]
            [/and]
            [and]
                [not]
                    [filter]
                        id=spawn_30_20
                    [/filter]
                [/not]
            [/and]
        [/store_locations]
        [set_variable]
            name=i
            rand=0..$($hex.length-1)
        [/set_variable]
        [move_unit]
            id=spawn_30_20
            to_x,to_y=$hex[$i].x,$hex[$i].y
            fire_event=yes
        [/move_unit]

        [store_locations]
            variable=hex
            x=16-27
            y=15-18
            [and]
                [filter_adjacent_location]
                    [filter]
                        id=spawn_20_17
                    [/filter]
                    radius=2
                [/filter_adjacent_location]
            [/and]
            [and]
                [not]
                    [filter]
                        id=spawn_20_17
                    [/filter]
                [/not]
            [/and]
        [/store_locations]
        [set_variable]
            name=i
            rand=0..$($hex.length-1)
        [/set_variable]
        [move_unit]
            id=spawn_20_17
            to_x,to_y=$hex[$i].x,$hex[$i].y
            fire_event=yes
        [/move_unit]

        [store_locations]
            variable=hex
            x=27-38
            y=4-8
            [and]
                [filter_adjacent_location]
                    [filter]
                        id=spawn_32_8
                    [/filter]
                    radius=2
                [/filter_adjacent_location]
            [/and]
            [and]
                [not]
                    [filter]
                        id=spawn_32_8
                    [/filter]
                [/not]
            [/and]
        [/store_locations]
        [set_variable]
            name=i
            rand=0..$($hex.length-1)
        [/set_variable]
        [move_unit]
            id=spawn_32_8
            to_x,to_y=$hex[$i].x,$hex[$i].y
            fire_event=yes
        [/move_unit]

        [store_locations]
            variable=hex
            x=1-21
            y=2-10
            [and]
                [filter_adjacent_location]
                    [filter]
                        id=spawn_8_8
                    [/filter]
                    radius=2
                [/filter_adjacent_location]
            [/and]
            [and]
                [not]
                    [filter]
                        id=spawn_8_8
                    [/filter]
                [/not]
            [/and]
        [/store_locations]
        [set_variable]
            name=i
            rand=0..$($hex.length-1)
        [/set_variable]
        [move_unit]
            id=spawn_8_8
            to_x,to_y=$hex[$i].x,$hex[$i].y
            fire_event=yes
        [/move_unit]

        {CLEAR_VARIABLE i}
        {CLEAR_VARIABLE hex}
    [/event]

# shops
    [event]
        name=moveto
        first_time_only=yes
        [filter]
            x=33,34,35,33-35
            y=21,20,21,22
            side=1
        [/filter]
        [filter_condition]
            [variable]
                name=part1
                numerical_equals=1
            [/variable]
        [/filter_condition]
        [message]
            speaker=spawn_34_21
            message= _ "Say, haven't I seen you before?"
        [/message]
        [message]
            speaker=Aryel_Fake
            message= _ "Uhm, I don't think so? First time in the city."
        [/message]
        [message]
            speaker=spawn_34_21
            message= _ "You look like one of the gals back home. Pretty girl."
        [/message]
        [message]
            speaker=Aryel_Fake
            message= _ "Riiight. Sorry, but I don't have time to chat right now, old man. Got to go."
        [/message]
        [message]
            speaker=Aryel_Fake
            message= _ "<i>Phew, close one. Getting caught here would be a bit annoying.</i>"
        [/message]
        {VARIABLE_OP aryel.experience add 10}
    [/event]

    [event]
        name=moveto
        first_time_only=yes
        [filter]
            x=32,33,34,32-34
            y=19,20,19,18
            side=1
        [/filter]
        [filter_condition]
            [variable]
                name=part1
                numerical_equals=1
            [/variable]
        [/filter_condition]
        [message]
            speaker=spawn_33_19
            message= _ "(<i>whistles</i>) What's up, little ladies? Wanna go... hang out? Have some fun with a handsome guy like me?"
        [/message]
        [message]
            speaker=spawn_33_19
            message= _ "C'mon, you know you want to."
        [/message]
        [message]
            speaker=Esther_Fake
            message= _ "Just ignore him."
        [/message]
        [message]
            speaker=Aryel_Fake
            message= _ "Sheesh, these people have even less manners than your regular human."
        [/message]
        [message]
            speaker=Talya
            message= _ "Yep, Caerleon's not filled with the nicest people everywhere. Especially around here. Let's just keep going."
        [/message]
    [/event]

    [event]
        name=moveto
        first_time_only=no
        [filter]
            x=36,37,38,36-38
            y=19,20,19,18
            side=1
        [/filter]
        [filter_condition]
            [variable]
                name=found_kid
                numerical_equals=0
            [/variable]
            [and]
                [variable]
                    name=part1
                    numerical_equals=1
                [/variable]
            [/and]
        [/filter_condition]
        [message]
            speaker=spawn_37_19
            message= _ "You seen a little boy 'round here? 'bout yay tall, brown hair, green eyes..."
        [/message]
        [message]
            speaker=Talya
            message= _ "Lost kid? I guess we could have a look around to see if we could find him."
        [/message]
    [/event]
    [event]
        name=moveto
        first_time_only=yes
        [filter]
            x=36,37,38,36-38
            y=19,20,19,18
            side=1
        [/filter]
        [filter_condition]
            [variable]
                name=found_kid
                numerical_equals=1
            [/variable]
            [and]
                [variable]
                    name=part1
                    numerical_equals=1
                [/variable]
            [/and]
        [/filter_condition]
        [move_unit]
            id=kid
            to_x,to_y=37,19
        [/move_unit]
        [modify_unit]
            [filter]
                id=kid
            [/filter]
            side=2
        [/modify_unit]
        [message]
            speaker=spawn_37_19
            message= _ "There you are! Now, ya better listen 'ere young man-"
        [/message]
        [message]
            speaker=Talya
            message= _ "Kid was just looking in one of the shops for candy. Go easy on him."
        [/message]
        [message]
            speaker=spawn_37_19
            message= _ "Hmph. Here's somethin' for yer trouble. (<i>turns</i>) Now, like I was sayin', I told ya not ta keep runnin' off like that! Sheesh!"
        [/message]
        [message]
            speaker=kid
            message= _ "Sorry, dad..."
        [/message]
        [message]
            speaker=spawn_37_19
            message= _ "And look at me when yer talkin' to me!"
        [/message]
        [message]
            speaker=kid
            message= _ "Sorry..."
        [/message]
        [message]
            speaker=Talya
            message= _ "(<i>whispers</i>) Let's go."
        [/message]
        [message]
            speaker=narrator
            message= _ "You received some gold!"
        [/message]
        [store_gold]
            [filter_side]
                side=1
            [/filter_side]
            variable=side1gold
        [/store_gold]
        {VARIABLE_OP side1gold add 30}
        [modify_side]
            side=1
            gold=$side1gold
        [/modify_side]
        {CLEAR_VARIABLE side1gold}

        #ifdef EASY
        {VARIABLE_OP esther.experience add 50}
        {VARIABLE_OP aryel.experience add 50}
        #endif
        #ifdef NORMAL
        {VARIABLE_OP esther.experience add 40}
        {VARIABLE_OP aryel.experience add 40}
        #endif
        #ifdef HARD
        {VARIABLE_OP esther.experience add 20}
        {VARIABLE_OP aryel.experience add 20}
        #endif
        [store_unit]
            [filter]
                id=Talya
            [/filter]
            variable=talya
        [/store_unit]
        #ifdef EASY
        {VARIABLE_OP talya.experience add 50}
        #endif
        #ifdef NORMAL
        {VARIABLE_OP talya.experience add 40}
        #endif
        #ifdef HARD
        {VARIABLE_OP talya.experience add 20}
        #endif
        [unstore_unit]
            variable=talya
            find_vacant=no
            advance=no
        [/unstore_unit]
        {CLEAR_VARIABLE talya}
    [/event]
    [event]
        name=moveto
        [filter]
            x,y=39,22
            side=1
        [/filter]
        [filter_condition]
            [variable]
                name=part1
                numerical_equals=1
            [/variable]
        [/filter_condition]

        [unit]
            side=1
            id=kid
            name= _ "Timmy"
            type=Human Child
            random_traits=no
            x,y=39,22
            animate=yes
            find_vacant=yes
            unrenamable=yes
        [/unit]

        [set_variable]
            name=found_kid
            value=1
        [/set_variable]

    [/event]

# crypt
    [event]
        name=moveto
        first_time_only=yes
        [filter]
            x=37-39,36,40
            y=3,2,2
            side=1
        [/filter]
        [filter_condition]
            [variable]
                name=part1
                numerical_equals=1
            [/variable]
        [/filter_condition]

        [message]
            speaker=Esther_Fake
            message= _ "There's some incredible power emanating from within, way more pronounced than it was before. That wouldn't be Yumi, would it?"
        [/message]
        [message]
            speaker=Aryel_Fake
            message= _ "It's definitely not."
        [/message]
        [message]
            speaker=Esther_Fake
            message= _ "But you feel it too, don't you?"
        [/message]
        [message]
            speaker=Aryel_Fake
            message= _ "Yeah, but we can worry about that after we find Yumi."
        [/message]
        [message]
            speaker=Esther_Fake
            message= _ "Right."
        [/message]

        #ifdef EASY
        {VARIABLE_OP esther.experience add 25}
        {VARIABLE_OP aryel.experience add 25}
        #endif
        #ifdef NORMAL
        {VARIABLE_OP esther.experience add 20}
        {VARIABLE_OP aryel.experience add 20}
        #endif
        #ifdef HARD
        {VARIABLE_OP esther.experience add 10}
        {VARIABLE_OP aryel.experience add 10}
        #endif
    [/event]

# colosseum
    [event]
        name=moveto
        first_time_only=yes
        [filter]
            x=9-11,11
            y=23,22
            side=1
        [/filter]
        [filter_condition]
            [variable]
                name=part1
                numerical_equals=1
            [/variable]
        [/filter_condition]
        [message]
            speaker=spawn_10_22
            message= _ "Hey there! Come to watch a fight at the colosseum- hey, haven't I seen you before?"
        [/message]
        [message]
            speaker=Aryel_Fake
            message= _ "Who, me?"
        [/message]
        [message]
            speaker=spawn_10_22
            message= _ "Yes... weren't you a contestant here once upon a time?"
        [/message]
        [message]
            speaker=Aryel_Fake
            message= _ "No way. This is my first time here. Besides, I abhor violence."
        [/message]
        [message]
            speaker=Esther_Fake
            message= _ "(<i>rolls eyes</i>)"
        [/message]
        [message]
            speaker=Talya
            message= _ "(<i>snickers</i>)"
        [/message]
        [message]
            speaker=Talya
            message= _ "Yeah, she's my friend. Just showing her around the city. We were thinking about catching a fight later."
        [/message]
        [message]
            speaker=spawn_10_22
            message= _ "I see. Well, when you decide you want to watch a battle, come back and I'll get you some tickets."
        [/message]
        [message]
            speaker=Talya
            message= _ "Sure thing."
        [/message]

        #ifdef EASY
        {VARIABLE_OP aryel.experience add 25}
        #endif
        #ifdef NORMAL
        {VARIABLE_OP aryel.experience add 20}
        #endif
        #ifdef HARD
        {VARIABLE_OP aryel.experience add 10}
        #endif
        [store_unit]
            [filter]
                id=Talya
            [/filter]
            variable=talya
        [/store_unit]
        #ifdef EASY
        {VARIABLE_OP talya.experience add 25}
        #endif
        #ifdef NORMAL
        {VARIABLE_OP talya.experience add 20}
        #endif
        #ifdef HARD
        {VARIABLE_OP talya.experience add 10}
        #endif
        [unstore_unit]
            variable=talya
            find_vacant=no
            advance=no
        [/unstore_unit]
        {CLEAR_VARIABLE talya}
    [/event]

# temple
    [event]
        name=moveto
        first_time_only=yes
        [filter]
            x=2-4,3
            y=8-9,10
            side=1
        [/filter]
        [filter_condition]
            [variable]
                name=part1
                numerical_equals=1
            [/variable]
        [/filter_condition]

        [message]
            speaker=Esther_Fake
            message= _ "We don't have time to go in there right now."
        [/message]
        [message]
            speaker=Talya
            message= _ "We're already here, though. You might as well at least let me wash my face. I feel gross after traveling for so long without a bath."
        [/message]
        [message]
            speaker=Aryel_Fake
            message= _ "I guess my hair could use a good rinse too."
        [/message]
        [message]
            speaker=Esther_Fake
            message= _ "Well, okay, but make it fast."
        [/message]
        [store_unit]
            [filter]
                id=Talya
            [/filter]
            variable=talya
        [/store_unit]

        {VARIABLE_OP talya.max_hitpoints add 1}
        {VARIABLE_OP aryel.max_hitpoints add 1}
        [unstore_unit]
            variable=talya
            find_vacant=no
        [/unstore_unit]
        {CLEAR_VARIABLE talya}
    [/event]

# pantheon
    [event]
        name=moveto
        first_time_only=no
        [filter]
            x=16,20,17-19
            y=8,8,9
            side=1
        [/filter]
        [filter_condition]
            [variable]
                name=part1
                numerical_equals=1
            [/variable]
        [/filter_condition]
        [message]
            speaker=Aryel_Fake
            message= _ "We need to find Yumi before we go there."
        [/message]
    [/event]

    [event]
        name=moveto
        first_time_only=no
        [filter]
            id=Talya,Aryel_Fake,Esther_Fake
            [filter_adjacent]
                side=3
            [/filter_adjacent]
        [/filter]
        [filter_condition]
            [variable]
                name=part1
                numerical_equals=1
            [/variable]
        [/filter_condition]
        [message]
            speaker=spawn_20_17
            message= _ "Hey, aren't you- faerie! Help, help! The faerie are invading!"
        [/message]
        [message]
            speaker=Esther_Fake
            message= _ "We really needed to not get caught here..."
        [/message]
        [endlevel]
            result=defeat
        [/endlevel]
    [/event]
    [event]
        name=moveto
        first_time_only=no
        [filter]
            side=3
            [filter_adjacent]
                id=Talya,Aryel_Fake,Esther_Fake
            [/filter_adjacent]
        [/filter]
        [filter_condition]
            [variable]
                name=part1
                numerical_equals=1
            [/variable]
        [/filter_condition]
        [message]
            speaker=unit
            message= _ "Hey, aren't you- faerie! Help, help! The faerie are invading!"
        [/message]
        [message]
            speaker=Esther_Fake
            message= _ "We really needed to not get caught here..."
        [/message]
        [endlevel]
            result=defeat
        [/endlevel]
    [/event]

    [event]
        name=moveto
        [filter]
            x=1-3
            y=1-2
            side=1
        [/filter]

        [message]
            speaker=unit
            message= _ "Let's go!"
        [/message]
        {CLEAR_VARIABLE found_kid}

        [kill]
            side=2,3
        [/kill]
        [store_unit]
            [filter]
                id=Talya
            [/filter]
            variable=talya
        [/store_unit]
        [kill]
            id=Esther_Fake,Aryel_Fake,Talya
        [/kill]

        {FADE_SCREEN}
        [label]
            x,y=7,19
            text = _ ""
        [/label]
        [label]
            x,y=36,20
            text = _ ""
        [/label]
        [label]
            x,y=2,1
            text = _ ""
        [/label]
        [label]
            x,y=3,9
            text = _ ""
        [/label]
        [label]
            x,y=38,2
            text = _ ""
        [/label]
        [label]
            x,y=18,2
            text = _ ""
        [/label]
        [label]
            x,y=4,7
            text = _ "Arcaneum"
        [/label]
        {DELAY 750}

        [replace_map]
            map="{~add-ons/Genesis/episode1/maps/07b_Upper_District.map}"
            expand=yes
            shrink=yes
        [/replace_map]

        {UNFADE_SCREEN}
        [unstore_unit]
            variable=talya
            find_vacant=no
            x,y=32,16
        [/unstore_unit]
        [unit]
            side=1
            id=Esther_Fake
            name= _ "Esther"
            type=Fire Fae Wingless
            random_traits=no
            animate=yes
            x,y=31,16
            canrecruit=yes
            unrenamable=yes
        [/unit]
        [unit]
            side=1
            id=Aryel_Fake
            name= _ "Aryel"
            type=Blood Fae Wingless
            random_traits=no
            animate=yes
            x,y=30,16
            canrecruit=yes
            unrenamable=yes
        [/unit]

        {DELAY 500}
        {TURN_UNIT5 "Aryel_Fake"}

        [message]
            speaker=Aryel_Fake
            message= _ "Whoa. Isn't it a bit empty here?"
        [/message]
        [message]
            speaker=Talya
            message= _ "Maybe they're all in a meeting? Or, hmm. I mean, they did just capture Yumi, so maybe everyone has their hands full."
        [/message]
        [message]
            speaker=Esther_Fake
            message= _ "I don't think so. There's something up here, and by that I mean I have the same feeling as when we opened that crypt before. This whole place feels a bit off. We'd better be careful. Aryel, which way?"
        [/message]
        [message]
            speaker=Aryel_Fake
            message= _ "Right to the Arcaneum. They're keeping her inside it and there isn't another entrance. Figures."
        [/message]
        [message]
            speaker=Esther_Fake
            message= _ "Of course. We'll have to enter by force."
        [/message]
        [message]
            speaker=Aryel_Fake
            message= _ "And if they try to stop us?"
        [/message]
        [message]
            speaker=Esther_Fake
            message= _ "I'll take care of it."
        [/message]
        [objectives]
            {OBJECTIVE_VICTORY  ( _ "Reach the Arcaneum")}
        [/objectives]
        [set_variable]
            name=turn_count
            value=1
        [/set_variable]
        [set_variable]
            name=part1
            value=0
        [/set_variable]
        [set_variable]
            name=part2
            value=1
        [/set_variable]
    [/event]
    [event]
        name=new turn
        first_time_only=no
        [filter_condition]
            [variable]
                name=part2
                numerical_equals=1
            [/variable]
        [/filter_condition]

        {VARIABLE_OP turn_count add 1}
    [/event]
    [event]
        name=side 1 turn

        [filter_condition]
            [variable]
                name=turn_count
                numerical_equals=2
            [/variable]
            [and]
                [variable]
                    name=part2
                    numerical_equals=1
                [/variable]
            [/and]
        [/filter_condition]
        [message]
            speaker=Esther_Fake
            message= _ "By the way, Talya. You don't have to come with us if you don't want to. I don't want to force you to fight against your colleagues-"
        [/message]
        [message]
            speaker=Talya
            message= _ "This is my problem as much as it is yours. Besides, between you and me, my 'colleagues' aren't really that nice. It'd be better if you didn't hurt the cute apprentices, though. I don't think they'll oppose you."
        [/message]
        [message]
            speaker=Esther_Fake
            message= _ "Hopefully we won't have to hurt anyone..."
        [/message]
        [message]
            speaker=Aryel_Fake
            message= _ "Yeah, that's not happening."
        [/message]
        [message]
            speaker=Esther_Fake
            message= _ "... but if it comes to violence, we have no choice."
        [/message]
    [/event]
    [event]
        name=side 1 turn

        [filter_condition]
            [variable]
                name=turn_count
                numerical_equals=4
            [/variable]
            [variable]
                name=part2
                numerical_equals=1
            [/variable]
        [/filter_condition]
        [message]
            speaker=Talya
            message= _ "(<i>whispers</i>) Is it just me, or does Esther seem... different?"
        [/message]
        [message]
            speaker=Aryel_Fake
            message= _ "(<i>whispers</i>) She's mad."
        [/message]
        [message]
            speaker=Talya
            message= _ "(<i>whispers</i>) Really? She doesn't seem that angry."
        [/message]
        [message]
            speaker=Aryel_Fake
            message= _ "(<i>whispers</i>) Not yet, she doesn't. If she decides to show it, it won't be pretty."
        [/message]
        [message]
            speaker=Talya
            message= _ "(<i>whispers</i>) Oh. I see."
        [/message]
    [/event]

    [event]
        name=moveto

        [filter]
            x=4,4
            y=6,7
            side=1
        [/filter]
        [filter_condition]
            [variable]
                name=part2
                numerical_equals=1
            [/variable]
        [/filter_condition]
        [set_variable]
            name=part2
            value=0
        [/set_variable]
        [message]
            speaker=Aryel_Fake
            message= _ "Talya was sort of right. There's a lot of them in a meeting right now. There's also a lot of guards by the prison entrance. Pretty unlikely that they'll just let us waltz by."
        [/message]
        [message]
            speaker=Esther_Fake
            message= _ "We'll have to convince them to let us pass."
        [/message]
        [message]
            speaker=Aryel_Fake
            message= _ "I don't think words are going to solve our problem-"
        [/message]
        [message]
            speaker=Esther_Fake
            message= _ "(<i>turns</i>) Aryel, maybe it's best if you get past the guards and go look for Yumi once we're inside. Talya, you might want to go with her too."
        [/message]
        [message]
            speaker=Talya
            message= _ "Erm... sure. If we can't talk them down at all, I'll go with Aryel. Even if I don't really like some of my colleagues, I'd rather not fight them if I don't have to."
        [/message]
        [message]
            speaker=Esther_Fake
            message= _ "Of course, that's understandable. So, are you two ready?"
        [/message]
        [message]
            speaker=Talya
            message= _ "As ready as I'll ever be, I guess."
        [/message]
        [message]
            speaker=Aryel_Fake
            message= _ "Let's break down that door."
        [/message]
        {DELAY 500}
        [store_unit]
            [filter]
                id=Talya
            [/filter]
            variable=talya
        [/store_unit]
        [kill]
            id=Esther_Fake,Aryel_Fake,Talya
        [/kill]
        {FADE_SCREEN}
        {DELAY 550}
        {PLAY_SOUND "dragonstick.ogg"}
        {DELAY 1250}

        [replace_map]
            map="{~add-ons/Genesis/episode1/maps/17a_Ashen_Hearts.map}"
            expand=yes
            shrink=yes
        [/replace_map]
        [modify_side]
            side=1
            shroud=yes
        [/modify_side]
        [label]
            x,y=4,7
            text = _ ""
        [/label]
        {GUARDIAN_ID "Mage" 3 15 20 "apprentice" "female"}

        {GUARDIAN_NOID "Red Mage" 4 6 12}
        {GUARDIAN_NOID "Red Mage" 4 3 8}
        {GUARDIAN_NOID "Red Mage" 4 18 13}
        {GUARDIAN_NOID "White Mage" 4 21 12}
        {GUARDIAN_NOID "White Mage" 4 18 10}
        {GUARDIAN_NOID "Red Mage" 4 21 9}

        {GUARDIAN_ID "Mage of Light" 5 9 7 "mage1" "male"}
        {GUARDIAN_ID "Necromancer" 5 15 7 "mage2" "male"}
        {GUARDIAN_ID "Silver Mage" 5 15 5 "mage3" "male"}
        {GUARDIAN_ID "Arch Mage" 5 9 5 "mage4" "male"}
        {GUARDIAN_ID "Arch Mage" 5 12 8 "mage5" "male"}
        {GUARDIAN_ID_NAME "Great Mage" 5 12 3 "mage6" "male" "Chairman Gereon"}

        [unstore_unit]
            variable=aryel
            x,y=19,25
            find_vacant=no
            advance=no
        [/unstore_unit]
        [redraw]
            side=1
            clear_shroud=yes
        [/redraw]
        {SCROLL_TO 19 24}
        [kill]
            id=Aryel
        [/kill]
        [change_theme]
            theme=
        [/change_theme]
        {UNFADE_SCREEN}

        [unstore_unit]
            variable=aryel
            x,y=19,25
            find_vacant=no
            advance=no
        [/unstore_unit]
        [unstore_unit]
            variable=esther
            x,y=19,24
            find_vacant=no
            advance=no
        [/unstore_unit]
        [unstore_unit]
            variable=talya
            x,y=20,24
            find_vacant=no
            advance=no
        [/unstore_unit]
        {CLEAR_VARIABLE talya}
        [redraw]
            side=1
            clear_shroud=yes
        [/redraw]

        [message]
            speaker=Talya
            message= _ "The main meeting chamber is straight ahead. There's an entrance to one of the prisons near it, but there are other ones as well. We might have to look around-"
        [/message]
        [message]
            speaker=Aryel
            message= _ "No. Yumi's there. They're taking her down right now."
        [/message]
        [message]
            speaker=Esther
            message= _ "And in the meeting chamber?"
        [/message]
        [message]
            speaker=Aryel
            message= _ "There are quite a few of the magi there. The entrance to the prison is guarded as well."
        [/message]
        [message]
            speaker=Esther
            message= _ "So we won't be sneaking around. In that case, we'd better be prepared to fight."
        [/message]
        [objectives]
            {OBJECTIVE_VICTORY  ( _ "Reach the prison door")}
            {OBJECTIVE_DEFEAT  ( _ "Death of Esther")}
            {OBJECTIVE_DEFEAT  ( _ "Death of Aryel")}
            {OBJECTIVE_DEFEAT  ( _ "Death of Talya")}
        [/objectives]
        {CLEAR_VARIABLE turn_count}
        [set_variable]
            name=part3
            value=1
        [/set_variable]
    [/event]

    [event]
        name=sighted
        first_time_only=yes
        [filter]
            side=3
        [/filter]
        [filter_second]
            side=1
        [/filter_second]
        [filter_condition]
            [variable]
                name=part3
                numerical_equals=1
            [/variable]
        [/filter_condition]

        {DELAY 250}
        {GUARDIAN_NOID "Mage" 3 14 19}
        {GUARDIAN_NOID "Mage" 3 14 20}
        [redraw][/redraw]

        [message]
            speaker=apprentice
            message= _ "Eek! It's the-"
        [/message]
        [message]
            speaker=Talya
            message= _ "Shhh!"
        [/message]
        [message]
            speaker=apprentice
            message= _ "P-professor? Is that you?"
        [/message]
        [move_unit]
            id=Talya
            to_x,to_y=16,20
        [/move_unit]
        [redraw]
            side=1
            clear_shroud=yes
        [/redraw]
        [message]
            speaker=Talya
            message= _ "(<i>takes off glasses</i>) Yes. As you can see, I've brought back some friends-"
        [/message]
        [message]
            speaker=apprentice
            message= _ "But consorting with faerie is illegal now! Didn't you hear?"
        [/message]
        [message]
            speaker=Talya
            message= _ "I'm aware. Listen, all of you. Haven't you noticed something going on with the rest of the mage council? And the rest of the city? You don't really think the faerie are evil, do you?"
        [/message]
        [message]
            speaker=apprentice
            message= _ "N-no, but..."
        [/message]
        [message]
            speaker=Talya
            message= _ "Exactly, so hush up and listen. Someone's manipulating the leadership here and we're here to figure out who that might be and how to stop them. I promise everything will go back to normal soon."
        [/message]
        [message]
            speaker=apprentice
            message= _ "W-well, it's just... you were kind of my favorite professor, a-and I wouldn't want to see you get hurt or anything..."
        [/message]
        [message]
            speaker=Talya
            message= _ "Awh. That's sweet, but you know I've got my responsibilities. In the meantime, I want you apprentices to stay hidden, okay? You have nothing to do with this, so there's no reason for you to needlessly involve yourselves in any of this dangerous mess."
        [/message]
        [message]
            speaker=apprentice
            message= _ "Okay..."
        [/message]
        [message]
            speaker=Talya
            message= _ "Besides, isn't it that time of year when examinations are coming up? You lot should have quite some studying to be doing, right now."
        [/message]
        [message]
            speaker=apprentice
            message= _ "(<i>blushes</i>) E-erm, yes ma'am. We'll get back to studying."
        [/message]
        {DELAY 500}
        [kill]
            side=3
        [/kill]
        {DELAY 350}
        [message]
            speaker=Talya
            message= _ "Good grief. Sorry about that. Let's keep going."
        [/message]
    [/event]

    [event]
        name=sighted
        first_time_only=yes
        [filter]
            side=4
        [/filter]
        [filter_second]
            side=1
        [/filter_second]
        [filter_condition]
            [variable]
                name=part3
                numerical_equals=1
            [/variable]
        [/filter_condition]
        [message]
            speaker=unit
            message= _ "Intruders! Faerie! And they brought the traitor with them!"
        [/message]
        [message]
            speaker=Aryel
            message= _ "Here we go again..."
        [/message]
        [message]
            speaker=Talya
            message= _ "Guys, guys. We're not here to fight you-"
        [/message]
        [message]
            speaker=unit
            message= _ "Sound the alarms! Kill the traitor and subdue the faerie!"
        [/message]
        [message]
            speaker=Aryel
            message= _ "Yep. Knew he'd say something like that. And actually, Talya, I think we kind of are here to fight them."
        [/message]
        [message]
            speaker=Talya
            message= _ "(<i>sighs</i>) I guess so. Well, I can't say I wasn't expecting it at all."
        [/message]
    [/event]
    [event]
        name=sighted
        first_time_only=yes
        [filter]
            side=5
        [/filter]
        [filter_second]
            side=1
        [/filter_second]
        [filter_condition]
            [variable]
                name=part3
                numerical_equals=1
            [/variable]
        [/filter_condition]
        [message]
            speaker=unit
            message= _ "Chairman, the intruders have come! And they have brought the traitor! What shall we do?"
        [/message]
        [message]
            speaker=mage6
            message= _ "How did they- never mind. Grant them an audience."
        [/message]
        [message]
            speaker=unit
            message= _ "But-"
        [/message]
        [message]
            speaker=mage6
            message= _ "We'll listen to what they have to say. It will be much easier for both us and the blue one if they're agreeable, don't you think?"
        [/message]
        [message]
            speaker=unit
            message= _ "Fine. Yes, sir."
        [/message]
        [message]
            speaker=Talya
            message= _ "The blue one..?"
        [/message]
        [message]
            speaker=Aryel
            message= _ "Suspicious..."
        [/message]
        [message]
            speaker=Esther
            message= _ "Just be ready for anything. Talya, stay back a little."
        [/message]
        {FADE_SCREEN}
        [store_unit]
            [filter]
                id=Esther
            [/filter]
            variable=esther
        [/store_unit]
        [store_unit]
            [filter]
                id=Aryel
            [/filter]
            variable=aryel
        [/store_unit]
        [store_unit]
            [filter]
                id=Talya
            [/filter]
            variable=talya
        [/store_unit]
        [kill]
            id=Esther,Aryel,Talya
        [/kill]
        [kill]
            side=4
        [/kill]

        [modify_side]
            side=1
            shroud=no
        [/modify_side]
        [redraw]
            side=1
            clear_shroud=yes
        [/redraw]

        {DELAY 500}
        [change_theme]
            theme=Cutscene_Minimal
        [/change_theme]
        {UNFADE_SCREEN}

        {GUARDIAN_ID "Royal Guard" 4 9 10 "guard1" "male"}
        {GUARDIAN_ID "Royal Guard" 4 15 10 "guard2" "male"}
        {GUARDIAN_ID "Royal Guard" 4 7 9 "guard3" "male"}
        {GUARDIAN_ID "Royal Guard" 4 17 9 "guard4" "male"}
        {GUARDIAN_ID "Iron Mauler" 4 1 7 "guard5" "male"}

        [unstore_unit]
            variable=aryel
            x,y=11,12
            find_vacant=no
            advance=no
        [/unstore_unit]
        [unstore_unit]
            variable=esther
            x,y=12,11
            find_vacant=no
            advance=no
        [/unstore_unit]
        [unstore_unit]
            variable=talya
            x,y=13,12
            find_vacant=no
            advance=no
        [/unstore_unit]
        [unhide_unit]
            [filter][/filter]
        [/unhide_unit]
        {CLEAR_VARIABLE esther}
        {CLEAR_VARIABLE aryel}
        {CLEAR_VARIABLE talya}

        [fade_out_music][/fade_out_music]
        [message]
            speaker=mage6
            message= _ "Welcome to Caerleon, faeries. Forgive the lack of manners from my subordinates-"
        [/message]
        [move_unit]
            id=Esther
            to_x,to_y=12,10
        [/move_unit]
        [message]
            speaker=Esther
            message= _ "Cut the fake pleasantries. You kidnapped our friend. Let her go."
        [/message]
        {DELAY 1000}
        [message]
            speaker=mage4
            message= _ "(<i>chuckles</i>) Interesting."
        [/message]
        [message]
            speaker=Aryel
            message= _ "What's so funny?"
        [/message]
        [message]
            speaker=mage3
            message= _ "The arrogance of you faeries knows no bounds."
        [/message]
        [message]
            speaker=mage1
            message= _ "You attack our armies, kill our people-"
        [/message]
        [message]
            speaker=mage2
            message= _ "Invade our city, threaten our apprentices-"
        [/message]
        [message]
            speaker=Talya
            message= _ "We did no such thing!"
        [/message]
        [message]
            speaker=mage5
            message= _ "And you march into our council to make such ridiculous requests."
        [/message]
        [message]
            speaker=Esther
            message= _ "(<i>breathes</i>)"
        [/message]
        [message]
            speaker=Esther
            message= _ "Maybe I wasn't clear. What I said earlier was not a request. It was a demand. Let her go."
        [/message]
        [message]
            speaker=mage6
            message= _ "This is what we mean by arrogance. There are three of you and six of us, along with all of our guards, and you have the gall to demand anything out of us-"
        [/message]
        {REPEAT 3 ({QUAKE_FIXED "rumble.ogg"})}
        [message]
            speaker=Esther
            message= _ "One more time. Let her go."
        [/message]
        [message]
            speaker=Aryel
            message= _ "Seriously. What do you even want with her?"
        [/message]
        [message]
            speaker=mage6
            message= _ "I was requested by an - ahem - colleague to bring her in for study. What that colleague wants to do with her is none of your business."
        [/message]
        [message]
            speaker=Aryel
            message= _ "It most certainly is. Even Talya thinks you're wrong for kidnapping Yumi."
        [/message]
        [message]
            speaker=mage6
            message= _ "What that traitor thinks is not of any concern to us. Although, we must thank you for bringing her back. We'll be taking custody of her now."
        [/message]
        {REPEAT 2 ({QUAKE_FIXED "rumble.ogg"})}
        [message]
            speaker=Esther
            message= _ "Aryel. You and Talya go."
        [/message]
        [message]
            speaker=Talya
            message= _ "But-"
        [/message]
        [message]
            speaker=Aryel
            message= _ "Okay. We'll be back soon."
        [/message]
        [message]
            speaker=Talya
            message= _ "But Aryel-"
        [/message]
        [message]
            speaker=Aryel
            message= _ "We discussed this before. We're getting out of here."
        [/message]
        [message]
            speaker=mage6
            message= _ "Foolish girls. As if we would just let you go. Guards!"
        [/message]
        [move_unit]
            id=guard1
            to_x,to_y=10,10
        [/move_unit]
        [move_unit]
            id=guard2
            to_x,to_y=14,10
        [/move_unit]
        [message]
            speaker=Esther
            message= _ "I don't think so."
        [/message]
        {REPEAT 3 ({QUAKE_FIXED "rumble.ogg"})}
        {FLASH_RED_EXTREME ({DELAY 250})}
        {DELAY 150}
        {PLAY_SOUND "melee-fire.ogg"}
        {DELAY 250}
        [kill]
            id=guard1
            animate=yes
        [/kill]
        [kill]
            id=guard2
            animate=yes
        [/kill]
        [message]
            speaker=mage4
            message= _ "Y-you fiend! How dare you!"
        [/message]
        [message]
            speaker=Esther
            message= _ "(<i>eyes narrow</i>) Shut up."
        [/message]
        {FLASH_RED_EXTREME ({DELAY 250})}
        {DELAY 150}
        {PLAY_SOUND "melee-fire.ogg"}
        [harm_unit]
            [filter]
                id=mage4
            [/filter]
            amount=25
            animate=yes
        [/harm_unit]
        [message]
            speaker=Esther
            message= _ "Go, you two."
        [/message]
        {REPEAT 2 ({QUAKE_FIXED "rumble.ogg"})}
        {FLASH_RED_EXTREME ({DELAY 250})}
        {PLAY_SOUND "melee-fire.ogg"}
        [message]
            speaker=Aryel
            message= _ "Come onnn!"
        [/message]
        [move_unit]
            id=Aryel
            to_x,to_y=1,8
        [/move_unit]
        [move_unit]
            id=Talya
            to_x,to_y=2,7
        [/move_unit]
        {SCROLL_TO 1 7}
        [message]
            speaker=Aryel
            message= _ "Get out of the way!"
        [/message]
        [message]
            speaker=guard5
            message= _ "You'll have to make me."
        [/message]
        [message]
            speaker=Aryel
            message= _ "Easy enough."
        [/message]
        [harm_unit]
            [filter]
                id=guard5
            [/filter]
            [filter_second]
                id=Aryel
            [/filter_second]
            [primary_attack]
                name=blood boil
            [/primary_attack]
            [secondary_attack]
                name=blood boil
            [/secondary_attack]
            animate=yes
            amount=30
        [/harm_unit]
        {REPEAT 2 ({QUAKE_FIXED "rumble.ogg"})}
        [message]
            speaker=guard5
            message= _ "Agh!"
        [/message]
        [message]
            speaker=Aryel
            message= _ "Let us pass and I won't kill you."
        [/message]
        [message]
            speaker=guard5
            message= _ "Never!"
        [/message]
        [harm_unit]
            [filter]
                id=guard5
            [/filter]
            [filter_second]
                id=Aryel
            [/filter_second]
            [primary_attack]
                name=blood boil
            [/primary_attack]
            [secondary_attack]
                name=blood boil
            [/secondary_attack]
            animate=yes
            kill=yes
            amount=99
        [/harm_unit]
        [message]
            speaker=Aryel
            message= _ "Let's go."
        [/message]
        [store_unit]
            [filter]
                id=Aryel
            [/filter]
            variable=aryel
        [/store_unit]
        [store_unit]
            [filter]
                id=Talya
            [/filter]
            variable=talya
        [/store_unit]
        [move_unit]
            id=Aryel
            to_x,to_y=1,6
        [/move_unit]
        [kill]
            id=Aryel
        [/kill]
        [move_unit]
            id=Talya
            to_x,to_y=1,6
        [/move_unit]
        [kill]
            id=Talya
        [/kill]
        {DELAY 550}
        {SCROLL_TO 12 10}
        {REPEAT 2 ({QUAKE_FIXED "rumble.ogg"})}
        {PLAY_SOUND "flame-big.ogg"}
        [terrain]
            x,y=12,10
            terrain=Uzw
        [/terrain]
        [redraw][/redraw]
        {DELAY 350}
        {REPEAT 2 ({QUAKE_FIXED "rumble.ogg"})}
        {PLAY_SOUND "flame-big.ogg"}
        [terrain]
            x,y=12,10
            radius=1
            terrain=Uzw
        [/terrain]
        [redraw][/redraw]
        [message]
            speaker=mage6
            message= _ "I always knew the faerie were evil. Get her!"
        [/message]
        {REPEAT 2 ({QUAKE_FIXED "rumble.ogg"})}
        {PLAY_SOUND "melee-fire.ogg"}
        {DELAY 150}
        {PLAY_SOUND "dragonstick.ogg"}
        {FLASH_RED_EXTREME ({DELAY 250})}
        {DELAY 150}
        {PLAY_SOUND "dragonstick.ogg"}
        {DELAY 250}
        [kill]
            id=guard3
            animate=yes
        [/kill]
        [kill]
            id=guard4
            animate=yes
        [/kill]
        {REPEAT 2 ({QUAKE_FIXED "rumble.ogg"})}
        [terrain]
            x,y=12,10
            radius=2
            terrain=Uzw
        [/terrain]
        [redraw][/redraw]
        {DELAY 250}
        {PLAY_SOUND "melee-fire.ogg"}
        {DELAY 150}
        {PLAY_SOUND "dragonstick.ogg"}
        [kill]
            id=mage5
            animate=yes
        [/kill]
        [kill]
            id=mage3
            animate=yes
        [/kill]
        {DELAY 250}
        [message]
            speaker=Esther
            message= _ "Evil? You humans drive us out of our homes, hound us across the entire northland, then take a helpless girl captive, and you think <i>we</i> are evil? Aryel was right. I've been far too merciful for too long."
        [/message]
        {REPEAT 3 ({QUAKE_FIXED "rumble.ogg"})}
        {DELAY 250}
        {PLAY_SOUND "dragonstick.ogg"}
        {DELAY 250}
        {COLOR_ADJUST 67 0 0}
        {DELAY 100}
        {COLOR_ADJUST 100 0 0}
        {DELAY 100}
        {COLOR_ADJUST 133 0 0}
        {DELAY 350}
        [kill]
            id=mage2
            animate=yes
        [/kill]
        [kill]
            id=mage4
            animate=yes
        [/kill]
        [kill]
            id=mage1
            animate=yes
        [/kill]
        {DELAY 150}
        {COLOR_ADJUST 167 0 0}
        {DELAY 100}
        {COLOR_ADJUST 200 0 0}
        {DELAY 100}
        {COLOR_ADJUST 255 0 0}
        {DELAY 750}
        {FADE_SCREEN}

        {DELAY 750}

        {CLEAR_VARIABLE part1}
        {CLEAR_VARIABLE part2}
        {CLEAR_VARIABLE part3}

        [endlevel]
            result=victory
            bonus=no
            {NEW_GOLD_CARRYOVER 100}
            replay_save=no
            carryover_report=no
            linger_mode=no
            next_scenario=17b_Ashen_Hearts
        [/endlevel]
    [/event]

    [event]
        name=last breath
        [filter]
            id=Yumi
        [/filter]

        [message]
            speaker=Yumi
            message= _ "(<i>gasp</i>)"
        [/message]
        [endlevel]
            result=defeat
        [/endlevel]
    [/event]
    [event]
        name=last breath
        [filter]
            id=Esther
        [/filter]

        [message]
            speaker=Esther
            message= _ "I... failed..."
        [/message]
        [endlevel]
            result=defeat
        [/endlevel]
    [/event]
    [event]
        name=last breath
        [filter]
            id=Aryel
        [/filter]

        [message]
            speaker=Aryel
            message= _ "Ah..."
        [/message]
        [endlevel]
            result=defeat
        [/endlevel]
    [/event]
    [event]
        name=last breath
        [filter]
            id=Talya
        [/filter]

        [message]
            speaker=Talya
            message= _ "Ow!"
        [/message]

        [endlevel]
            result=defeat
        [/endlevel]
    [/event]
[/scenario]
