#textdomain wesnoth-Genesis
[scenario]
    id=04b_Woodland_Dreams
    name= _ "Woodland Dreams"
    map_data="{~add-ons/Genesis/episode1/maps/04b_Woodland_Dreams.map}"
    next_scenario=03_Northlands
    victory_when_enemies_defeated=no
    disallow_recall=yes
    {TURNS 14 13 12}
    {ETERNALDARKSWAMP}

    {SCENARIO_MUSIC underground.ogg}
    {EXTRA_SCENARIO_MUSIC weight_of_revenge.ogg}
    {EXTRA_SCENARIO_MUSIC transience.ogg}

    {FAE_DEATHS}
    [side]
        type=Fire Fae
        name= _ "Esther"
        id=Esther
        canrecruit=yes
        side=1
        controller=human
        recruit=
        {GOLD 200 175 150}
        team_name=fae
        user_team_name= _ "team_name^Fae"
        fog=yes
        shroud=yes
    [/side]

    [side]
        side=2
        no_leader=yes
        team_name=spirits
        controller=ai
        user_team_name= _ "team_name^Spirits"
        [ai]
            aggression=1
            caution=0
            grouping=false
        [/ai]
    [/side]

    [side]
        side=3
        no_leader=yes
        team_name=fae
        controller=ai
        user_team_name= _ "team_name^Spirits"
        fog=no
        shroud=no
        [ai]
            aggression=1
            caution=0
            grouping=false
        [/ai]
    [/side]

    # allied ghosts

    #ifdef HARD
        {RESPAWN_POINT_RANDOM ("Manifestation") 3 5 12 21 25 3}
        {RESPAWN_POINT_RANDOM ("Manifestation") 3 18 22 23 26 3}
        {RESPAWN_POINT_RANDOM ("Manifestation") 3 1 5 17 20 3}
    #endif
    #ifdef NORMAL
        {RESPAWN_POINT_RANDOM ("Manifestation") 3 5 12 21 25 2}
        {RESPAWN_POINT_RANDOM ("Manifestation") 3 18 22 23 26 2}
        {RESPAWN_POINT_RANDOM ("Manifestation") 3 1 5 17 20 2}
    #endif
    #ifdef EASY
        {RESPAWN_POINT_RANDOM ("Manifestation") 3 5 12 21 25 1}
        {RESPAWN_POINT_RANDOM ("Manifestation") 3 18 22 23 26 2}
        {RESPAWN_POINT_RANDOM ("Manifestation") 3 1 5 17 20 1}
    #endif

    # enemy ghosts

    #ifdef HARD
        {RESPAWN_POINT_RANDOM ("Wraith","Shadow") 2 1 4 1 3 12}
        {RESPAWN_POINT_RANDOM ("Wraith","Shadow") 2 19 24 19 22 12}
        {RESPAWN_POINT ("Wraith","Shadow") 2 17 4 12}
        {RESPAWN_POINT ("Wraith","Shadow") 2 13 3 12}
        {RESPAWN_POINT ("Wraith") 2 14 6 14}
        {RESPAWN_POINT ("Wraith") 2 17 8 14}
        {RESPAWN_POINT ("Wraith") 2 15 13 14}
        {RESPAWN_POINT ("Wraith") 2 20 10 14}
        {RESPAWN_POINT ("Wraith") 2 26 9 14}
        {RESPAWN_POINT ("Wraith") 2 24 11 14}
        {RESPAWN_POINT ("Wraith") 2 25 13 14}
        {RESPAWN_POINT ("Wraith","Shadow") 2 25 17 12}
        {RESPAWN_POINT ("Wraith","Shadow") 2 21 16 12}
    #endif
    #ifdef NORMAL
        {RESPAWN_POINT_RANDOM ("Wraith","Shadow") 2 1 4 1 3 20}
        {RESPAWN_POINT_RANDOM ("Wraith","Shadow") 2 19 24 19 22 20}
        {RESPAWN_POINT ("Wraith","Shadow") 2 17 4 20}
        {RESPAWN_POINT ("Wraith","Shadow") 2 13 3 20}
        {RESPAWN_POINT ("Wraith") 2 14 6 19}
        {RESPAWN_POINT ("Wraith") 2 17 8 19}
        {RESPAWN_POINT ("Wraith") 2 15 13 19}
        {RESPAWN_POINT ("Wraith") 2 20 10 19}
        {RESPAWN_POINT ("Wraith") 2 26 9 19}
        {RESPAWN_POINT ("Wraith") 2 24 11 19}
        {RESPAWN_POINT ("Wraith") 2 25 13 19}
        {RESPAWN_POINT ("Wraith","Shadow") 2 25 17 20}
        {RESPAWN_POINT ("Wraith","Shadow") 2 21 16 20}
    #endif
    #ifdef EASY
        {RESPAWN_POINT_RANDOM ("Wraith","Shadow") 2 1 4 1 3 24}
        {RESPAWN_POINT_RANDOM ("Wraith","Shadow") 2 19 24 19 22 24}
        {RESPAWN_POINT ("Wraith","Shadow") 2 17 4 24}
        {RESPAWN_POINT ("Wraith","Shadow") 2 13 3 24}
        {RESPAWN_POINT ("Wraith") 2 14 6 21}
        {RESPAWN_POINT ("Wraith") 2 17 8 21}
        {RESPAWN_POINT ("Wraith") 2 15 13 21}
        {RESPAWN_POINT ("Wraith") 2 20 10 21}
        {RESPAWN_POINT ("Wraith") 2 26 9 21}
        {RESPAWN_POINT ("Wraith") 2 24 11 21}
        {RESPAWN_POINT ("Wraith") 2 25 13 21}
        {RESPAWN_POINT ("Wraith","Shadow") 2 25 17 24}
        {RESPAWN_POINT ("Wraith","Shadow") 2 21 16 24}
    #endif
    {RESPAWN_POINT_RANDOM ("Manifestation") 2 9 19 15 19 18}
    {RESPAWN_POINT_RANDOM ("Manifestation") 2 9 19 15 19 18}
    {RESPAWN_POINT_RANDOM ("Manifestation") 2 9 19 15 19 18}
    {RESPAWN_POINT_RANDOM ("Manifestation") 2 9 19 15 19 18}
    {RESPAWN_POINT_RANDOM ("Manifestation") 2 9 19 15 19 18}
    {RESPAWN_POINT_RANDOM ("Manifestation") 2 9 19 15 19 18}
    {RESPAWN_POINT_RANDOM ("Manifestation") 2 9 19 15 19 18}
    {RESPAWN_POINT_RANDOM ("Manifestation") 2 9 19 15 19 18}
    {RESPAWN_POINT_RANDOM ("Manifestation") 2 9 19 15 19 18}

    [event]
        name=start
        [if]
            [variable]
                name=black_cauldron
                numerical_equals=0
            [/variable]
            [then]
                {RECALL_YUMI_NOLOC}

                [message]
                    speaker=Yumi
                    message= _ "Ughh, my head..."
                [/message]
                [message]
                    speaker=Esther
                    message= _ "Are you okay? You're not hurt, right?"
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "Mmm..."
                [/message]
                [message]
                    speaker=Esther
                    message= _ "Alright, so  where are we?"
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "... No idea."
                [/message]
                [message]
                    speaker=Esther
                    message= _ "Something feels off. Something about this place seems not quite... real."
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "Maybe it's not. Maybe we got sucked into another dimension or something."
                [/message]
                [message]
                    speaker=Esther
                    message= _ "That's not good. If that's the case, we'll have to figure out a way out of here as soon as possible. Getting stuck in unfamiliar magics for too long often means it'll be impossible to escape when the spell strengthens."
                [/message]

                [objectives]
                    {OBJECTIVE_VICTORY  ( _ "Find a way to escape")}
                    {OBJECTIVE_DEFEAT  ( _ "Death of Esther")}
                    {OBJECTIVE_DEFEAT  ( _ "Death of Yumi")}
                    {OBJECTIVE_DEFEAT ( _ "Turns run out")}
                    {OBJECTIVE_FULL_CARRYOVER}
                    {OBJECTIVE_NOTE ( _ "Units will automatically spawn to help you fight enemies.")}
                    {OBJECTIVE_NOTE ( _ "You may recruit Manifestations from hexes adjacent to Yumi.")}
                    {OBJECTIVE_NOTE ( _ "Recruited Manifestations will die at the end of the scenario.")}
                    {OBJECTIVE_NOTE ( _ "Search to the north-east.")}
                [/objectives]
            [/then]
            [else]
                {RECALL_YUMI_NOLOC}
                {RECALL_ARYEL_NOLOC}

                [message]
                    speaker=Yumi
                    message= _ "Ughh, my head..."
                [/message]
                [message]
                    speaker=Esther
                    message= _ "Are you okay? You're not hurt, right?"
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "Mmm..."
                [/message]
                [message]
                    speaker=Esther
                    message= _ "Alright, so  where are we?"
                [/message]
                [message]
                    speaker=Aryel
                    message= _ "Let's see."
                [/message]
                [message]
                    speaker=Aryel
                    message= _ "This energy feels familiar. Yumi, can you feel it?"
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "... Hmm. We're stuck in some kind of spell, right?"
                [/message]
                [message]
                    speaker=Esther
                    message= _ "That would make sense. Something about this place seems not exactly real."
                [/message]
                [message]
                    speaker=Aryel
                    message= _ "Other dimensions are sometimes detached from physical reality. However, this means that we can't stay here for too long. If we let the magic holding us here strengthen, it'll eventually become impossible to escape."
                [/message]
                [message]
                    speaker=Esther
                    message= _ "We'd better get going then."
                [/message]

                [objectives]
                    {OBJECTIVE_VICTORY  ( _ "Find a way to escape")}
                    {OBJECTIVE_DEFEAT  ( _ "Death of Esther")}
                    {OBJECTIVE_DEFEAT  ( _ "Death of Yumi")}
                    {OBJECTIVE_DEFEAT  ( _ "Death of Aryel")}
                    {OBJECTIVE_DEFEAT ( _ "Turns run out")}
                    {OBJECTIVE_CARRYOVER}
                    {OBJECTIVE_NOTE ( _ "Units will automatically spawn to help you fight enemies.")}
                    {OBJECTIVE_NOTE ( _ "You may recruit Manifestations from hexes adjacent to Yumi.")}
                    {OBJECTIVE_NOTE ( _ "Recruited Manifestations will die at the end of the scenario.")}
                    {OBJECTIVE_NOTE ( _ "Search to the north-east.")}
                [/objectives]
            [/else]
        [/if]

        [set_menu_item]
            id=recruit_ghost
            description= _ "Recruit Ghost"
            image="attacks/wail.png~SCALE(18,18)"
            [show_if]
                [variable]
                    name=side_number
                    numerical_equals=1
                [/variable]
            [/show_if]
            [filter_location]
                [not]
                    [filter][/filter]
                [/not]
                [filter_adjacent_location]
                    [filter]
                        side=1
                        id=Aryel
                    [/filter]
                [/filter_adjacent_location]
            [/filter_location]
            [command]
                [store_gold]
                    [filter_side]
                        side=1
                    [/filter_side]
                    variable=side1gold
                [/store_gold]
                [if]
                    [variable]
                        name=side1gold
                        less_than=20
                    [/variable]
                    [then]
                        [message]
                            speaker=narrator
                            message= _ "You do not have enough gold!"
                        [/message]
                    [/then]
                    [else]
                        [unit]
                            side=1
                            type=Ghost
                            x,y=$x1,$y1
                            moves,attacks_left=0,0
                            animate=yes
                        [/unit]
                        {VARIABLE_OP side1gold sub 20}
                        [modify_side]
                            side=1
                            gold=$side1gold
                        [/modify_side]
                        {CLEAR_VARIABLE side1gold}
                    [/else]
                [/if]
            [/command]
        [/set_menu_item]
        [set_menu_item]
            id=recruit_manifestation
            description= _ "Recruit Manifestation"
            image="attacks/wail.png~SCALE(18,18)"
            [show_if]
                [variable]
                    name=side_number
                    numerical_equals=1
                [/variable]
            [/show_if]
            [filter_location]
                [not]
                    [filter][/filter]
                [/not]
                [filter_adjacent_location]
                    [filter]
                        side=1
                        id=Yumi
                    [/filter]
                [/filter_adjacent_location]
            [/filter_location]
            [command]
                [store_gold]
                    [filter_side]
                        side=1
                    [/filter_side]
                    variable=side1gold
                [/store_gold]
                [if]
                    [variable]
                        name=side1gold
                        less_than=6
                    [/variable]
                    [then]
                        [message]
                            speaker=narrator
                            message= _ "You do not have enough gold!"
                        [/message]
                    [/then]
                    [else]
                        [unit]
                            side=1
                            type=Manifestation
                            x,y=$x1,$y1
                            moves,attacks_left=0,0
                            animate=yes
                        [/unit]
                        {VARIABLE_OP side1gold sub 6}
                        [modify_side]
                            side=1
                            gold=$side1gold
                        [/modify_side]
                        {CLEAR_VARIABLE side1gold}
                    [/else]
                [/if]
            [/command]
        [/set_menu_item]
    [/event]

    [event]
        name=sighted
        first_time_only=yes
        [filter]
            side=2
        [/filter]

        [message]
            speaker=Esther
            message= _ "Spirits? Strange. I would've thought the demons would be here."
        [/message]
        [if]
            [variable]
                name=black_cauldron
                numerical_equals=1
            [/variable]
            [then]
                [message]
                    speaker=Aryel
                    message= _ "Some of them appear to be on our side too. That's odd."
                [/message]
            [/then]
            [else]
                [message]
                    speaker=Yumi
                    message= _ "Not all of them seem to be against us..."
                [/message]
            [/else]
        [/if]
        [message]
            speaker=Esther
            message= _ "That's good. Maybe we'll have an easier time then."
        [/message]
    [/event]

    [event]
        name=turn 3
        [if]
            [variable]
                name=black_cauldron
                numerical_equals=0
            [/variable]
            [then]
                [message]
                    speaker=narrator
                    message= _ "<i>Can you feel it? By this point, a sensitive one like you surely must have realized...</i>"
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "(<i>holds head</i>)"
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "Ugh..."
                [/message]
                [message]
                    speaker=Esther
                    message= _ "Is something wrong?"
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "No... no. It's nothing."
                [/message]
                [message]
                    speaker=narrator
                    message= _ "<i>So you say. You must think that this is just your imagination. Of course, many have thought that before.</i>"
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "It's not just... just..."
                [/message]
                [message]
                    speaker=Esther
                    message= _ "Yumi? Snap out of it!"
                [/message]

                {DELAY 1500}

                [message]
                    speaker=Esther
                    message= _ "What's going on? Are you hurt? Yumi-"
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "(<i>shakes head</i>) I'm... okay. I just realized, we're dealing with demon magic here. That's why this place seems so bleak."
                [/message]
                [message]
                    speaker=Esther
                    message= _ "And? There's something else you haven't said."
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "I haven't figured anything else out yet. Sorry."
                [/message]
                [message]
                    speaker=Esther
                    message= _ "That's not what I meant."
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "(<i>bites lip</i>) I wasn't going to say anything else, though."
                [/message]
                [message]
                    speaker=Esther
                    message= _ "Sure, you weren't."
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "I wasn't! Esther, nothing's wrong. I promise. Let's just keep going."
                [/message]
                [message]
                    speaker=Esther
                    message= _ "(<i>sighs</i>)"
                [/message]
            [/then]
            [else]
                [message]
                    speaker=narrator
                    message= _ "<i>Can you feel it? By this point, a sensitive one like you surely must have realized...</i>"
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "(<i>holds head</i>)"
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "Ugh..."
                [/message]
                [message]
                    speaker=Esther
                    message= _ "Is something wrong?"
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "No... no. It's nothing."
                [/message]
                [message]
                    speaker=Aryel
                    message= _ "(<i>frowns</i>) She's lying-"
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "I'm not lying! I'm not..."
                [/message]
                [message]
                    speaker=narrator
                    message= _ "<i>So you say. You must think that this is just your imagination. Of course, many have thought that before.</i>"
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "It's not just... just..."
                [/message]
                [message]
                    speaker=Esther
                    message= _ "Yumi? Snap out of it!"
                [/message]

                {DELAY 1500}

                [message]
                    speaker=Aryel
                    message= _ "Yumi. Yuuumi."
                [/message]
                [message]
                    speaker=Aryel
                    message= _ "Something's not quite right."
                [/message]

                {DELAY 1000}

                [message]
                    speaker=Yumi
                    message= _ "(<i>shakes head</i>) I'm... okay. I just realized, we're dealing with demon magic here. That's why this place seems so bleak."
                [/message]
                [message]
                    speaker=Aryel
                    message= _ "... and? You're keeping something else from us."
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "I'm not!"
                [/message]
                [message]
                    speaker=Aryel
                    message= _ "(<i>eyes narrowed</i>) You can't keep secrets from me."
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "I'm really not."
                [/message]
                [message]
                    speaker=Aryel
                    message= _ "Liar! Seriously, why do you insist on making us worry?"
                [/message]
                [message]
                    speaker=Esther
                    message= _ "We're your friends, right? You don't have to hide from us."
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "(<i>bites lip</i>) I wasn't going to say anything else. There's nothing else to say."
                [/message]
                [message]
                    speaker=Esther
                    message= _ "Right."
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "Nothing's wrong. I promise."
                [/message]
                [message]
                    speaker=Esther
                    message= _ "(<i>sighs</i>)"
                [/message]
            [/else]
        [/if]
    [/event]

    [event]
        name=turn 6
        [message]
            speaker=narrator
            message= _ "<i>Why do you hide from them? What do you fear?</i>"
        [/message]
        [message]
            speaker=Yumi
            message= _ "<i>I... it doesn't matter. Why would something like that matter to you?</i>"
        [/message]
        [message]
            speaker=narrator
            message= _ "<i>We do not have to be your enemies. It does not have to be like this.</i>"
        [/message]
        [message]
            speaker=Yumi
            message= _ "<i>... what do you mean?</i>"
        [/message]
        [message]
            speaker=narrator
            message= _ "<i>We do not intend to hurt you. There is something we need you for.</i>"
        [/message]
        [message]
            speaker=Yumi
            message= _ "<i>Like what? I'm just a normal faerie.</i>"
        [/message]
        [message]
            speaker=narrator
            message= _ "<i>Normal is hardly the word to describe you.</i>"
        [/message]
        [message]
            speaker=Yumi
            message= _ "<i>I'm not special at all. You must be looking for the wrong person...</i>"
        [/message]
        [message]
            speaker=Esther
            message= _ "Yumi? Hello? You okay?"
        [/message]
        [message]
            speaker=Yumi
            message= _ "Huh? Oh, I thought I saw something, but it was just a weirdly shaped tree."
        [/message]
        [message]
            speaker=Esther
            message= _ "... right. Okay."
        [/message]
    [/event]

    [event]
        name=turn 9

        [store_unit]
            [filter]
                id=Yumi
            [/filter]
            variable=yumi
        [/store_unit]

        [if]
            [variable]
                name=black_cauldron
                numerical_equals=0
            [/variable]
            [then]


                [message]
                    speaker=Yumi
                    message= _ "(<i>pales</i>)"
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "(<i>coughs</i>)"
                [/message]
                [message]
                    speaker=Esther
                    message= _ "Yumi? You don't look so good."
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "I... feel... sick. (<i>cough</i>)"
                [/message]
                [message]
                    speaker=Esther
                    message= _ "That's... no. You're going to tell me what's wrong."
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "I... I..."
                [/message]
                [if]
                    [variable]
                        name=yumi.hitpoints
                        numerical_equals=1
                    [/variable]
                    [then]
                        [harm_unit]
                            [filter]
                                id=Yumi
                            [/filter]
                            amount=0
                            animate=yes
                        [/harm_unit]
                    [/then]
                    [else]
                        [harm_unit]
                            [filter]
                                id=Yumi
                            [/filter]
                            amount=2
                            kill=no
                            animate=yes
                        [/harm_unit]
                    [/else]
                [/if]
                [message]
                    speaker=Esther
                    message= _ "Are you okay? Yumi? Please, look at me."
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "Try-ing - (<i>gasps</i>)"
                [/message]
                [if]
                    [variable]
                        name=yumi.hitpoints
                        numerical_equals=1
                    [/variable]
                    [then]
                        [harm_unit]
                            [filter]
                                id=Yumi
                            [/filter]
                            amount=0
                            animate=yes
                        [/harm_unit]
                    [/then]
                    [else]
                        [harm_unit]
                            [filter]
                                id=Yumi
                            [/filter]
                            amount=2
                            kill=no
                            animate=yes
                        [/harm_unit]
                    [/else]
                [/if]

                {DELAY 300}

                [if]
                    [variable]
                        name=yumi.hitpoints
                        numerical_equals=1
                    [/variable]
                    [then]
                        [harm_unit]
                            [filter]
                                id=Yumi
                            [/filter]
                            amount=0
                            animate=yes
                        [/harm_unit]
                    [/then]
                    [else]
                        [harm_unit]
                            [filter]
                                id=Yumi
                            [/filter]
                            amount=3
                            kill=no
                            animate=yes
                        [/harm_unit]
                    [/else]
                [/if]
                [message]
                    speaker=Esther
                    message= _ "Yumi!"
                [/message]

                {DELAY 1500}

                [message]
                    speaker=Yumi
                    message= _ "(<i>breathes deeply</i>)"
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "Sorry. It's the demon magic... apparently my body can't handle it. If I stay here for too long, it'll kill me."
                [/message]
                [message]
                    speaker=Esther
                    message= _ "That's not good, but okay. Okay, if that's the only thing... for a moment, I thought... I thought you were really hurt..."
                [/message]
                [message]
                    speaker=narrator
                    message= _ "<i>But, you are, aren't you? Why do you still hide?</i>"
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "(<i>shakes head</i>)  No, I'm actually okay. It was... just... just for a moment."
                [/message]
                [message]
                    speaker=narrator
                    message= _ "<i>Do you still intend to fight us?</i>"
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "... but really, it's not good if we stay here forever."
                [/message]
                [message]
                    speaker=Esther
                    message= _ "Right. Let's find a way out of here, then."
                [/message]
            [/then]
            [else]
                [message]
                    speaker=Yumi
                    message= _ "(<i>pales</i>)"
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "(<i>coughs</i>)"
                [/message]
                [message]
                    speaker=Esther
                    message= _ "Yumi? You don't look so good."
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "I... feel... sick. (<i>cough</i>)"
                [/message]
                [message]
                    speaker=Aryel
                    message= _ "No, that's not it. Yumi..."
                [/message]
                [message]
                    speaker=Esther
                    message= _ "Yumi, stop hiding from us. We're here to help you!"
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "I... I..."
                [/message]
                [if]
                    [variable]
                        name=yumi.hitpoints
                        numerical_equals=1
                    [/variable]
                    [then]
                        [harm_unit]
                            [filter]
                                id=Yumi
                            [/filter]
                            amount=0
                            animate=yes
                        [/harm_unit]
                    [/then]
                    [else]
                        [harm_unit]
                            [filter]
                                id=Yumi
                            [/filter]
                            amount=2
                            kill=no
                            animate=yes
                        [/harm_unit]
                    [/else]
                [/if]
                [message]
                    speaker=Esther
                    message= _ "Are you okay? Please, look at me."
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "Try-ing - (<i>gasps</i>)"
                [/message]
                [if]
                    [variable]
                        name=yumi.hitpoints
                        numerical_equals=1
                    [/variable]
                    [then]
                        [harm_unit]
                            [filter]
                                id=Yumi
                            [/filter]
                            amount=0
                            animate=yes
                        [/harm_unit]
                    [/then]
                    [else]
                        [harm_unit]
                            [filter]
                                id=Yumi
                            [/filter]
                            amount=2
                            kill=no
                            animate=yes
                        [/harm_unit]
                    [/else]
                [/if]

                {DELAY 300}

                [if]
                    [variable]
                        name=yumi.hitpoints
                        numerical_equals=1
                    [/variable]
                    [then]
                        [harm_unit]
                            [filter]
                                id=Yumi
                            [/filter]
                            amount=0
                            animate=yes
                        [/harm_unit]
                    [/then]
                    [else]
                        [harm_unit]
                            [filter]
                                id=Yumi
                            [/filter]
                            amount=3
                            kill=no
                            animate=yes
                        [/harm_unit]
                    [/else]
                [/if]
                [message]
                    speaker=Aryel
                    message= _ "Yumi! Esther, I think she's really hurt! We have to help her!"
                [/message]
                [move_unit]
                    id=Aryel
                    to_x=$yumi.x
                    to_y=$yumi.y
                [/move_unit]

                {DELAY 1500}

                [message]
                    speaker=Yumi
                    message= _ "(<i>breathes deeply</i>)"
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "Sorry. It's the demon magic... apparently my body can't handle it. If I stay here for too long, it'll kill me."
                [/message]
                [message]
                    speaker=Aryel
                    message= _ "..."
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "I'm being serious!"
                [/message]
                [message]
                    speaker=Aryel
                    message= _ "I don't believe you."
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "(<i>shakes head</i>)  I'm actually okay. I'm not making it up. Esther, you believe me, right?"
                [/message]
                [message]
                    speaker=Esther
                    message= _ "Uhm... I think... she seems like she's being honest, for once."
                [/message]
                [message]
                    speaker=Aryel
                    message= _ "(<i>glares</i>) Trust me, she's lying."
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "I'm not! Aryel, please."
                [/message]
                [message]
                    speaker=Aryel
                    message= _ "You totally are."
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "(<i>pouts</i>)"
                [/message]
                [message]
                    speaker=Aryel
                    message= _ "Ugh, whatever. You're hopeless..."
                [/message]
            [/else]
        [/if]
        {CLEAR_VARIABLE yumi}
    [/event]

    [event]
        name=turn 11
        [message]
            speaker=Yumi
            message= _ "We should hurry up..."
        [/message]
    [/event]
    [event]
        name=turn 12
        [message]
            speaker=Yumi
            message= _ "We really should get out of here."
        [/message]
    [/event]

    [event]
        name=moveto
        [filter]
            [filter_location]
                terrain=Gll^Fp
            [/filter_location]
            side=1
        [/filter]
        [message]
            speaker=Esther
            message= _ "Forests! And look, I see a dead tree over there. Yumi, you should come here and take a look at it. That might be our way out of here!"
        [/message]
    [/event]
    [event]
        name=moveto
        [filter]
            x,y=23,3
            id=Esther,Aryel
        [/filter]
        [message]
            speaker=unit
            message= _ "Yumi, you should probably come take a look at this."
        [/message]
    [/event]
    [event]
        name=moveto
        [filter]
            x,y=23,3
            id=Yumi
        [/filter]

        [switch]
            variable=black_cauldron
            [case]
                value=0
                [message]
                    speaker=Yumi
                    message= _ "There seems to be some kind of spell sapping the life from the tree."
                [/message]
                [message]
                    speaker=Esther
                    message= _ "Can you heal it?"
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "I think so. Let me try."
                [/message]

                {DELAY 500}
                {PLAY_SOUND "magic-dark.ogg"}
                {DELAY 500}
                {PLAY_SOUND "magic-faeriefire.ogg"}
                {DELAY 500}

                [message]
                    speaker=Yumi
                    message= _ "Okay, I think that worked. It should start healing soon."
                [/message]

                {DELAY 750}
                [terrain]
                    x=34
                    y=4
                    terrain=Gg^Fet
                [/terrain]
                {DELAY 750}

                [message]
                    speaker=Esther
                    message= _ "I feel a little woozy."
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "Me too. Maybe it means we're getting out of here now."
                [/message]
                [message]
                    speaker=Esther
                    message= _ "Hopefully."
                [/message]

                {DELAY 750}
            [/case]
            [case]
                value=1
                [message]
                    speaker=Yumi
                    message= _ "There seems to be some kind of spell sapping the life from the tree."
                [/message]
                [message]
                    speaker=Aryel
                    message= _ "Demon magic, you mean."
                [/message]
                [message]
                    speaker=Esther
                    message= _ "Can you heal it?"
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "I think so. Let me try."
                [/message]

                {DELAY 500}
                {PLAY_SOUND "magic-dark.ogg"}
                {DELAY 500}
                {PLAY_SOUND "magic-faeriefire.ogg"}
                {DELAY 500}

                [message]
                    speaker=Yumi
                    message= _ "Okay, I think that worked. It should start healing soon."
                [/message]

                {DELAY 750}
                [terrain]
                    x=34
                    y=4
                    terrain=Gg^Fet
                [/terrain]
                {DELAY 750}

                [message]
                    speaker=Esther
                    message= _ "I feel a little woozy."
                [/message]
                [message]
                    speaker=Yumi
                    message= _ "Me too."
                [/message]
                [message]
                    speaker=Aryel
                    message= _ "The spell's lifting. We should be out of here any minute now."
                [/message]

                {DELAY 750}
            [/case]
        [/switch]

        {PLAY_SOUND "lightning.ogg"}
        {DELAY 500}
        [clear_menu_item]
            id=recruit_ghost,recruit_manifestation
        [/clear_menu_item]
        [set_variable]
            name=woodland_dreams
            value=1
        [/set_variable]
        [set_variable]
            name=prev_scenario
            value="Woodland Dreams"
        [/set_variable]
        [kill]
            side=1
            type=Manifestation
        [/kill]
        [endlevel]
            result=victory
            bonus=yes
            {NEW_GOLD_CARRYOVER 100}
            carryover_report=no
            linger_mode=no
            next_scenario=03_Northlands
        [/endlevel]
    [/event]


    [event]
        name=time over
        [message]
            speaker=Yumi
            message= _ "We're going to be stuck in here forever..."
        [/message]

        [endlevel]
            result=defeat
        [/endlevel]
    [/event]
[/scenario]
