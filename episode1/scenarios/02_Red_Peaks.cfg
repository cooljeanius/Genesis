#textdomain wesnoth-Genesis

[scenario]
    id=02_Red_Peaks
    name= _ "Red Peaks"
    map_data="{~add-ons/Genesis/episode1/maps/02_Red_Peaks.map}"
    {TURNS 33 31 29}
    next_scenario=03_Northlands
    victory_when_enemies_defeated=no
    {DEFAULT_SCHEDULE}
    {STORYTXT_RED_PEAKS}

    {SCENARIO_MUSIC battle-epic.ogg}
    {EXTRA_SCENARIO_MUSIC nunc_dimittis.ogg}
    {EXTRA_SCENARIO_MUSIC breaking_the_chains.ogg}
    {EXTRA_SCENARIO_MUSIC the_king_is_dead.ogg}

    {FAE_DEATHS}

    [side]
        type=Fire Fae
        name= _ "Esther"
        id=Esther
        canrecruit=yes
        side=1
        controller=human
        recruit=Faerie Sprite,Dusk Faerie,Faerie Shaman
        {GOLD 250 225 200}
        {INCOME 7 6 5}
        village_gold=2
        village_support=1
        team_name=fae
        user_team_name= _ "team_name^Fae"
        fog=yes
        {VILLAGE 21 45}
        {VILLAGE 19 48}
        {VILLAGE 19 45}
        {VILLAGE 18 46}
        {VILLAGE 20 46}
    [/side]

    [side]
        side=2
        no_leader=yes
        team_name=demons
        user_team_name= _ "team_name^Demons"
        [ai]
            aggression=1
            caution=0
            grouping=false
        [/ai]
    [/side]

    [side]
        side=3
        no_leader=yes
        team_name=demons
        user_team_name= _ "team_name^Imps"
        [ai]
            aggression=1
            caution=0
            grouping=false
        [/ai]
    [/side]

    [side]
        side=4
        no_leader=yes
        team_name=fae
        user_team_name= _ "team_name^Demons"
        share_view=yes
        [ai]
            aggression=1
            caution=0
        [/ai]
    [/side]

    # demon spawns
    #ifdef HARD
        {RESPAWN_POINT_RANDOM ("Demon Zephyr","Demon Windlasher") 2 16 18 39 42 16}
        {RESPAWN_POINT_RANDOM ("Demon Zephyr") 2 13 15 39 42 15}
        {RESPAWN_POINT_RANDOM ("Demon Zephyr","Demon Windlasher") 2 10 12 39 42 16}
        {RESPAWN_POINT_RANDOM ("Demon Zephyr") 2 3 7 48 52 15}
        {RESPAWN_POINT_RANDOM ("Demon Zephyr","Demon Windlasher") 2 27 31 37 40 16}
        {RESPAWN_POINT_RANDOM ("Demon Zephyr","Demon Windlasher") 2 25 29 29 33 16}
        {RESPAWN_POINT_RANDOM ("Demon Zephyr") 2 28 31 30 34 15}
        {RESPAWN_POINT_RANDOM ("Demon Zephyr") 2 3 8 42 47 15}
        {RESPAWN_POINT_RANDOM ("Demon Zephyr") 2 25 30 29 31 15}
    #endif
    #ifdef NORMAL
        {RESPAWN_POINT_RANDOM ("Demon Zephyr","Demon Windlasher") 2 16 18 39 42 24}
        {RESPAWN_POINT_RANDOM ("Winged Demon") 2 13 15 39 42 16}
        {RESPAWN_POINT_RANDOM ("Demon Zephyr") 2 10 12 39 42 20}
        {RESPAWN_POINT_RANDOM ("Demon Zephyr") 2 3 7 48 52 20}
        {RESPAWN_POINT_RANDOM ("Winged Demon") 2 27 31 37 40 16}
        {RESPAWN_POINT_RANDOM ("Winged Demon") 2 25 29 29 33 16}
        {RESPAWN_POINT_RANDOM ("Demon Zephyr","Demon Windlasher") 2 28 31 30 34 24}
        {RESPAWN_POINT_RANDOM ("Demon Zephyr") 2 3 8 42 47 20}
        {RESPAWN_POINT_RANDOM ("Winged Demon") 2 25 30 29 31 16}
    #endif
    #ifdef EASY
        {RESPAWN_POINT_RANDOM ("Demon Zephyr") 2 16 18 39 42 24}
        {RESPAWN_POINT_RANDOM ("Winged Demon") 2 13 15 39 42 20}
        {RESPAWN_POINT_RANDOM ("Winged Demon") 2 10 12 39 42 20}
        {RESPAWN_POINT_RANDOM ("Demon Zephyr") 2 3 7 48 52 24}
        {RESPAWN_POINT_RANDOM ("Winged Demon") 2 27 31 37 40 20}
        {RESPAWN_POINT_RANDOM ("Winged Demon") 2 25 29 29 33 20}
        {RESPAWN_POINT_RANDOM ("Demon Zephyr") 2 28 31 30 34 24}
        {RESPAWN_POINT_RANDOM ("Demon Zephyr") 2 3 8 42 47 24}
        {RESPAWN_POINT_RANDOM ("Winged Demon") 2 25 30 29 31 20}
    #endif

    # variable set
    [event]
        name=prestart
        [set_variable]
            name=turn_counter
            value=0
        [/set_variable]
        [set_variable]
            name=new_spawns
            value=0
        [/set_variable]
    [/event]

    [event]
        name=start

        [message]
            speaker=Esther
            message= _ "Ready yet?"
        [/message]

        {RECALL_YUMI 32 46}
        [redraw]
            side=1
            clear_shroud=yes
        [/redraw]

        [message]
            speaker=Yumi
            message= _ "(<i>rubs eyes</i>) I guess. Where are we going?"
        [/message]
        [message]
            speaker=Esther
            message= _ "North."
        [/message]
        [message]
            speaker=Yumi
            message= _ "Why north?"
        [/message]
        [message]
            speaker=Esther
            message= _ "Because other people live there."
        [/message]
        [message]
            speaker=Esther
            message= _ "... is there a problem?"
        [/message]
        [message]
            speaker=Yumi
            message= _ "You're talking about Aryel, aren't you?"
        [/message]
        [message]
            speaker=Esther
            message= _ "What's wrong with Aryel?"
        [/message]
        [message]
            speaker=Yumi
            message= _ "Nothing... nothing at all..."
        [/message]
        [message]
            speaker=Esther
            message= _ "Why is your face so red?"
        [/message]
        [message]
            speaker=Yumi
            message= _ "It's nothing! She's just... uhm..."
        [/message]
        [message]
            speaker=Esther
            message= _ "Look, we might need her help, and I thought you liked her. So what's the big deal?"
        [/message]
        [message]
            speaker=Yumi
            message= _ "Nothing!"
        [/message]
        [message]
            speaker=Esther
            message= _ "You aren't hiding something from me, are you?"
        [/message]
        [message]
            speaker=Yumi
            message= _ "No..."
        [/message]
        [message]
            speaker=Esther
            message= _ "... If you're going to lie to me, you should at least make an effort to do better than that."
        [/message]
        [message]
            speaker=Yumi
            message= _ "Sorry..."
        [/message]
        [message]
            speaker=Esther
            message= _ "You know you don't have to be afraid of me, right?"
        [/message]
        [message]
            speaker=Yumi
            message= _ "I'm not."
        [/message]
        [message]
            speaker=Esther
            message= _ "I hope so. Sometimes it just doesn't seem like that."
        [/message]
        [message]
            speaker=Yumi
            message= _ "(<i>sulks</i>) You never believe me..."
        [/message]
        [message]
            speaker=Esther
            message= _ "I do! It's just, you're so quiet usually and... ah I'm sorry. I shouldn't be pushy."
        [/message]

        {DELAY 1000}

        [message]
            speaker=Esther
            message= _ "Anyway, we should get going."
        [/message]
        
        [objectives]
            {OBJECTIVE_VICTORY  ( _ "Reach the end of the mountain pass")}
            {OBJECTIVE_DEFEAT ( _ "Death of Esther")}
            {OBJECTIVE_DEFEAT ( _ "Death of Yumi")}
            {OBJECTIVE_DEFEAT ( _ "Turns run out")}
            {OBJECTIVE_CARRYOVER}
        [/objectives]
    [/event]

    # also damages fire fae and shadow fae
    # do not get caught in lava!
    #define KILL_UNITS_ON_LAVA
    [store_locations]
        variable=lava_hex
        terrain=Qlf
    [/store_locations]
    [for]
        array=lava_hex
        [do]
            [if]
                [have_unit]
                    x,y=$lava_hex[$i].x,$lava_hex[$i].y
                    [not]
                        type=Fire Fae, Shadow Fae, Winged Demon, Demon Zephyr, Demon Windlasher, Demon Stormbringer, Demon Galerunner,Demon Stromguarde,Serpent Messenger
                    [/not]
                [/have_unit]
                [then]
                    [kill]
                        x,y=$lava_hex[$i].x,$lava_hex[$i].y
                        animate=yes
                        fire_event=yes
                    [/kill]
                [/then]
            [/if]
        [/do]
    [/for]
    {CLEAR_VARIABLE lava_hex}
    #enddef

    [event]
        name=side 1 turn
        first_time_only=no
        [store_locations]
            variable=lava_hex
            terrain=Qlf
        [/store_locations]
        #ifndef HARD
            {VARIABLE tmp_lava_dmg 10}
        #endif
        #ifdef HARD
            {VARIABLE tmp_lava_dmg 15}
        #endif
        [for]
            array=lava_hex
            [do]
                [if]
                    [have_unit]
                        x,y=$lava_hex[$i].x,$lava_hex[$i].y
                        type=Fire Fae, Shadow Fae
                    [/have_unit]
                    [then]
                        {PLAY_SOUND "fire.wav"}
                        [harm_unit]
                            [filter]
                                x,y=$lava_hex[$i].x,$lava_hex[$i].y
                            [/filter]
                            amount=$tmp_lava_dmg
                            damage_type=fire
                            animate=yes
                            kill=no
                            fire_event=yes
                        [/harm_unit]
                    [/then]
                [/if]
            [/do]
        [/for]
        {CLEAR_VARIABLE tmp_lava_dmg}
        {CLEAR_VARIABLE lava_hex}
    [/event]

    [event]
        name=sighted
        first_time_only=yes
        [filter]
            side=2
        [/filter]
        [filter_second]
            side=1
        [/filter_second]

        [message]
            speaker=Esther
            message= _ "Watch out, the demons are still following us! Stick together and don't get picked off!"
        [/message]
    [/event]

    [event]
        name=sighted
        first_time_only=yes
        [filter]
            side=3
        [/filter]
        [filter_second]
            side=1
        [/filter_second]

        [message]
            speaker=Esther
            message= _ "They brought imps too? Looks like we might have more of a problem on our hands than I initially thought."
        [/message]
        [message]
            speaker=Yumi
            message= _ "Why? And what are imps?"
        [/message]
        [message]
            speaker=Esther
            message= _ "I forget you've never seen them before. Imps are just lesser demons."
        [/message]
        [message]
            speaker=Yumi
            message= _ "Then why should we be afraid of them?"
        [/message]
        [message]
            speaker=Esther
            message= _ "Because when demon insurrections happen, they're led by small groups of strong demons who try to undermine their Guardian's authority. Imps usually never do, so that means that someone who's really powerful is ordering these demons to attack. Maybe even Uria herself."
        [/message]
        [message]
            speaker=Yumi
            message= _ "(<i>frowns</i>) Okay."
        [/message]
    [/event]

    [event]
        name=turn 3

        [message]
            speaker=Yumi
            message= _ "Hey, Esther."
        [/message]
        [message]
            speaker=Esther
            message= _ "Yes?"
        [/message]
        [message]
            speaker=Yumi
            message= _ "Do you ever wonder about... ah..."
        [/message]
        [message]
            speaker=Esther
            message= _ "What is it? Spill it."
        [/message]
        [message]
            speaker=Yumi
            message= _ "... Do you think the other faeries know that we're... well..."
        [/message]
        [message]
            speaker=Esther
            message= _ "What do you mean?"
        [/message]
        [message]
            speaker=Yumi
            message= _ "Erm..."
        [/message]
        [message]
            speaker=Yumi
            message= _ "... never mind. Maybe I'll ask you some other time."
        [/message]
        [message]
            speaker=Esther
            message= _ "Yumi..."
        [/message]
        [message]
            speaker=Yumi
            message= _ "I'm sorry. I shouldn't have said anything."
        [/message]
        [message]
            speaker=Esther
            message= _ "It's- it's okay. You don't have to tell me now. We can talk later when you're ready. Okay?"
        [/message]
        [message]
            speaker=Yumi
            message= _ "Okay."
        [/message]
    [/event]

    [event]
        name=turn 5
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=0
            [/variable]
        [/filter_condition]

        [message]
            speaker=Yumi
            message= _ "I think I see smoke."
        [/message]
        [message]
            speaker=Esther
            message= _ "From the volcanoes? Hmm, in that case, we should start moving faster."
        [/message]
        [message]
            speaker=Esther
            message= _ "...Yumi? Hello?"
        [/message]
        [message]
            speaker=Esther
            message= _ "Come on, you don't want stay here and fight all those demons by yourself..."
        [/message]
        [message]
            speaker=Yumi
            message= _ "I don't."
        [/message]
        [message]
            speaker=Esther
            message= _ "Then what are you just standing there for?"
        [/message]
        [message]
            speaker=Yumi
            message= _ "It's... just, what about Xia'el? She's the Guardian of Irdya, right? She's supposed to protect us. We shouldn't have to be fighting these demons..."
        [/message]
        [message]
            speaker=Esther
            message= _ "But she's not here now, is she? We're on our own, Yumi, which means we can't just stand around and wait for her to save us."
        [/message]
        [message]
            speaker=Yumi
            message= _ "Then where is she?"
        [/message]
        [message]
            speaker=Esther
            message= _ "Who knows? The Guardians have their own politics going on. For all we know, she could be on Ethea right now."
        [/message]
        [message]
            speaker=Esther
            message= _ "Anyway, come on, you don't want to get caught if those volcanoes erupt on us."
        [/message]
        [message]
            speaker=Yumi
            message= _ "(<i>nods</i>)"
        [/message]
    [/event]

    # if you haven't set off the volcanoes by now, it's time to get moving
    [event]
        name=turn 8
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=0
            [/variable]
        [/filter_condition]

        [message]
            speaker=Esther
            message= _ "We should probably hurry up."
        [/message]
    [/event]

    [event]
        name=moveto
        first_time_only=yes
        [filter]
            x=8-15
            y=16-21
            side=1
        [/filter]

        [message]
            speaker=Esther
            message="Hey, I think I see an abandoned human castle. Maybe we can rally everyone there."
        [/message]
        [message]
            speaker=Yumi
            message="Uhm, with all this lava around us?"
        [/message]
        [message]
            speaker=Esther
            message="Ah, right."
        [/message]
    [/event]

    # volcano lava events
    # only do all the fancy interface stuff for the first turn this happens
    # spawns for the volcano event
    # these numbers can be tweaked
    #ifdef HARD
        {RESPAWN_POINT_CONDITIONAL ("Demon Zephyr","Demon Windlasher") 2 5 26 13 ("turn_counter")}
        {RESPAWN_POINT_CONDITIONAL ("Demon Zephyr","Demon Windlasher") 2 4 24 13 ("turn_counter")}
        {RESPAWN_POINT_CONDITIONAL ("Demon Zephyr","Demon Windlasher") 2 6 23 13 ("turn_counter")}
        {RESPAWN_POINT_CONDITIONAL ("Demon Zephyr","Demon Windlasher") 2 24 23 13 ("turn_counter")}
        {RESPAWN_POINT_CONDITIONAL ("Demon Zephyr","Demon Windlasher") 2 27 24 13 ("turn_counter")}
        {RESPAWN_POINT_CONDITIONAL ("Demon Zephyr","Demon Windlasher") 2 27 26 13 ("turn_counter")}
        {RESPAWN_POINT_CONDITIONAL ("Demon Zephyr","Demon Windlasher") 2 11 11 13 ("turn_counter")}
        {RESPAWN_POINT_CONDITIONAL ("Demon Zephyr","Demon Windlasher") 2 13 10 13 ("turn_counter")}
        {RESPAWN_POINT_CONDITIONAL ("Demon Zephyr","Demon Windlasher") 2 15 11 13 ("turn_counter")}
    #endif
    #ifdef NORMAL
        {RESPAWN_POINT_CONDITIONAL ("Demon Zephyr") 2 5 26 16 ("turn_counter")}
        {RESPAWN_POINT_CONDITIONAL ("Winged Demon") 2 4 24 12 ("turn_counter")}
        {RESPAWN_POINT_CONDITIONAL ("Demon Zephyr","Demon Windlasher") 2 6 23 20 ("turn_counter")}
        {RESPAWN_POINT_CONDITIONAL ("Demon Zephyr","Demon Windlasher") 2 24 23 20 ("turn_counter")}
        {RESPAWN_POINT_CONDITIONAL ("Winged Demon") 2 27 24 12 ("turn_counter")}
        {RESPAWN_POINT_CONDITIONAL ("Demon Zephyr") 2 27 26 16 ("turn_counter")}
        {RESPAWN_POINT_CONDITIONAL ("Winged Demon") 2 11 11 12 ("turn_counter")}
        {RESPAWN_POINT_CONDITIONAL ("Winged Demon") 2 13 10 12 ("turn_counter")}
        {RESPAWN_POINT_CONDITIONAL ("Winged Demon") 2 15 11 12 ("turn_counter")}
    #endif
    #ifdef EASY
        {RESPAWN_POINT_CONDITIONAL ("Demon Zephyr") 2 5 26 26 ("turn_counter")}
        {RESPAWN_POINT_CONDITIONAL ("Winged Demon") 2 4 24 16 ("turn_counter")}
        {RESPAWN_POINT_CONDITIONAL ("Demon Zephyr","Demon Windlasher") 2 6 23 22 ("turn_counter")}
        {RESPAWN_POINT_CONDITIONAL ("Demon Zephyr","Demon Windlasher") 2 24 23 22 ("turn_counter")}
        {RESPAWN_POINT_CONDITIONAL ("Winged Demon") 2 27 24 16 ("turn_counter")}
        {RESPAWN_POINT_CONDITIONAL ("Demon Zephyr") 2 27 26 26 ("turn_counter")}
        {RESPAWN_POINT_CONDITIONAL ("Winged Demon") 2 11 11 16 ("turn_counter")}
        {RESPAWN_POINT_CONDITIONAL ("Winged Demon") 2 13 10 16 ("turn_counter")}
        {RESPAWN_POINT_CONDITIONAL ("Winged Demon") 2 15 11 16 ("turn_counter")}
    #endif

    #ifdef HARD
        {RESPAWN_POINT_CONDITIONAL ("Blood Imp") 3 23 15 9 ("new_spawns")}
        {RESPAWN_POINT_CONDITIONAL ("Blood Imp") 3 23 17 9 ("new_spawns")}
        {RESPAWN_POINT_CONDITIONAL ("Blood Imp") 3 26 16 9 ("new_spawns")}
        {RESPAWN_POINT_CONDITIONAL ("Blood Imp") 3 24 13 9 ("new_spawns")}
        {RESPAWN_POINT_CONDITIONAL ("Blood Imp") 3 24 15 9 ("new_spawns")}
        {RESPAWN_POINT_CONDITIONAL ("Blood Imp") 3 27 14 9 ("new_spawns")}
        {RESPAWN_POINT_CONDITIONAL ("Serpent Messenger") 3 4 24 9 ("new_spawns")}
        {RESPAWN_POINT_CONDITIONAL ("Serpent Messenger") 3 27 24 9 ("new_spawns")}
        {RESPAWN_POINT_CONDITIONAL ("Serpent Messenger") 3 13 10 9 ("new_spawns")}
    #endif
    #ifdef NORMAL
        {RESPAWN_POINT_CONDITIONAL ("Blood Imp") 3 23 15 12 ("new_spawns")}
        {RESPAWN_POINT_CONDITIONAL ("Blood Imp") 3 23 17 12 ("new_spawns")}
        {RESPAWN_POINT_CONDITIONAL ("Imp") 3 26 16 12 ("new_spawns")}
        {RESPAWN_POINT_CONDITIONAL ("Imp") 3 24 13 12 ("new_spawns")}
        {RESPAWN_POINT_CONDITIONAL ("Blood Imp") 3 27 14 12 ("new_spawns")}
        {RESPAWN_POINT_CONDITIONAL ("Blood Imp") 3 24 15 12 ("new_spawns")}
        {RESPAWN_POINT_CONDITIONAL ("Serpent Messenger") 3 4 24 14 ("new_spawns")}
        {RESPAWN_POINT_CONDITIONAL ("Serpent Messenger") 3 27 24 14 ("new_spawns")}
        {RESPAWN_POINT_CONDITIONAL ("Serpent Messenger") 3 13 10 14 ("new_spawns")}
    #endif
    #ifdef EASY
        {RESPAWN_POINT_CONDITIONAL ("Imp") 3 23 15 15 ("new_spawns")}
        {RESPAWN_POINT_CONDITIONAL ("Blood Imp") 3 23 17 15 ("new_spawns")}
        {RESPAWN_POINT_CONDITIONAL ("Imp") 3 26 16 15 ("new_spawns")}
        {RESPAWN_POINT_CONDITIONAL ("Blood Imp") 3 24 13 15 ("new_spawns")}
        {RESPAWN_POINT_CONDITIONAL ("Imp") 3 27 14 15 ("new_spawns")}
        {RESPAWN_POINT_CONDITIONAL ("Imp") 3 24 15 15 ("new_spawns")}
        {RESPAWN_POINT_CONDITIONAL ("Serpent Messenger") 3 4 24 16 ("new_spawns")}
        {RESPAWN_POINT_CONDITIONAL ("Serpent Messenger") 3 27 24 16 ("new_spawns")}
        {RESPAWN_POINT_CONDITIONAL ("Serpent Messenger") 3 13 10 16 ("new_spawns")}
    #endif


    [event]
        name=moveto
        first_time_only=yes
        [filter]
            x=8-28
            y=27-31
            side=1
        [/filter]

        [message]
            speaker=Yumi
            message= _ "Do you hear something?"
        [/message]
        [message]
            speaker=Esther
            message= _ "Yes. It sounds like-"
        [/message]

        # 5 seems to be good, but it could be a little less or more
        # the repeat for sound makes it more impressive, more eruption-like
        {REPEAT 5 ({QUAKE_FIXED "rumble.ogg"})}
        {REPEAT 3 ({PLAY_SOUND "dragonstick.ogg"})}

        {REPLACE_SCENARIO_MUSIC franticsketch.ogg}
        {APPEND_MUSIC the_city_falls.ogg}
        {APPEND_MUSIC vengeful.ogg}

        {DELAY 1000}
        {PLAY_SOUND "rumble.ogg"}

        # the broken up scrolls and redraws make it seem like the lava is flowing
        [scroll_to]
            x,y=7,37
        [/scroll_to]

        [terrain]
            x=0,0
            y=36,39
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        {DELAY 1000}

        [terrain]
            x=1,1,1,1
            y=37,38,39,40
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        {DELAY 1000}

        [terrain]
            x=2
            y=39
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        {KILL_UNITS_ON_LAVA}
        {DELAY 1000}
        {PLAY_SOUND "rumble.ogg"}

        [scroll_to]
            x,y=9,25
        [/scroll_to]

        [terrain]
            x=6
            y=25
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        {DELAY 1000}

        [terrain]
            x=7,7
            y=25,26
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        {KILL_UNITS_ON_LAVA}
        {DELAY 1000}
        {PLAY_SOUND "rumble.ogg"}

        [scroll_to]
            x,y=24,25
        [/scroll_to]

        [terrain]
            x=26
            y=25
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        {DELAY 1000}

        [terrain]
            x=25,25
            y=25,26
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        {KILL_UNITS_ON_LAVA}
        {DELAY 1000}

        # here are some enemies
        #ifdef HARD
            {SPAWN ("Demon Zephyr","Demon Windlasher") 2 5 26}
            {SPAWN ("Demon Zephyr","Demon Windlasher") 2 6 23}
            {SPAWN ("Demon Zephyr","Demon Windlasher") 2 24 23}
            {SPAWN ("Demon Zephyr","Demon Windlasher") 2 27 26}
            {SPAWN ("Winged Demon") 2 11 11}
            {SPAWN ("Winged Demon") 2 15 11}
        #endif
        #ifdef NORMAL
            {SPAWN ("Winged Demon") 2 5 26}
            {SPAWN ("Winged Demon") 2 6 23}
            {SPAWN ("Winged Demon") 2 24 23}
            {SPAWN ("Winged Demon") 2 27 26}
            {SPAWN ("Demon Zephyr") 2 11 11}
            {SPAWN ("Demon Zephyr","Demon Windlasher") 2 15 11}
        #endif
        #ifdef EASY
            {SPAWN ("Winged Demon") 2 5 26}
            {SPAWN ("Winged Demon") 2 6 23}
            {SPAWN ("Winged Demon") 2 24 23}
            {SPAWN ("Winged Demon") 2 27 26}
            {SPAWN ("Winged Demon") 2 11 11}
            {SPAWN ("Winged Demon") 2 15 11}
        #endif

        [message]
            speaker=Esther
            message= _ "Oh dear, this is bad. Really bad. Stay off the lava, and stay close, everyone! We can't let them pick us off alone!"
        [/message]

        # since we don't know which turn this occurs on, use a counter to track it
        [set_variable]
            name=turn_counter
            value=1
        [/set_variable]
        [objectives]
            {OBJECTIVE_VICTORY  ( _ "Reach the end of the mountain pass")}
            {OBJECTIVE_DEFEAT ( _ "Death of Esther")}
            {OBJECTIVE_DEFEAT ( _ "Death of Yumi")}
            {OBJECTIVE_DEFEAT ( _ "Turns run out")}
            {OBJECTIVE_CARRYOVER}
            {OBJECTIVE_NOTE ( _ "Do not step on the lava.")}
        [/objectives]
    [/event]

    [event]
        name=turn refresh
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=1
            [/variable]
        [/filter_condition]
        [set_variable]
            name=turn_counter
            value=2
        [/set_variable]
    [/event]

    # make more lava, etc
    [event]
        name=new turn
        first_time_only=yes
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=2
            [/variable]
        [/filter_condition]

        {PLAY_SOUND "rumble.ogg"}

        [terrain]
            x=3,4,4,0,0,0,1,1
            y=39,38,37,45,46,47,46,47
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=7,8,8
            y=27,24,26
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=24,25,23,22,8
            y=25,27,25,24,23
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=13
            y=12
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        {KILL_UNITS_ON_LAVA}
        [set_variable]
            name=turn_counter
            value=3
        [/set_variable]
    [/event]

    [event]
        name=turn refresh
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=3
            [/variable]
        [/filter_condition]
        [set_variable]
            name=turn_counter
            value=4
        [/set_variable]
    [/event]

    [event]
        name=new turn
        first_time_only=yes
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=4
            [/variable]
        [/filter_condition]

        {PLAY_SOUND "rumble.ogg"}

        [terrain]
            x=5,5,5
            y=37,38,39
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=2,2,3
            y=46,47,47
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=7,9,8,9
            y=28,27,23,24
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=21,22,24,26,23
            y=25,23,27,27,28
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=12,14,10,17
            y=12,12,12,11
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        {KILL_UNITS_ON_LAVA}
        [set_variable]
            name=turn_counter
            value=5
        [/set_variable]
    [/event]

    [event]
        name=turn refresh
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=5
            [/variable]
        [/filter_condition]
        [set_variable]
            name=turn_counter
            value=6
        [/set_variable]
    [/event]

    [event]
        name=new turn
        first_time_only=yes
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=6
            [/variable]
        [/filter_condition]

        {PLAY_SOUND "rumble.ogg"}

        [terrain]
            x=5,6
            y=36,36-39
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=4-5
            y=46-47
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=8,7,10,9,10
            y=28,29,27,23,24
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=26,26,22,24,20,21,22
            y=28,29,28,26,25,23,22
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=17,18,16,11,9
            y=10,10,12,13,13
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        {KILL_UNITS_ON_LAVA}
        [set_variable]
            name=turn_counter
            value=7
        [/set_variable]
    [/event]

    [event]
        name=turn refresh
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=7
            [/variable]
        [/filter_condition]
        [set_variable]
            name=turn_counter
            value=8
        [/set_variable]
    [/event]
    [event]
        name=new turn
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=8
            [/variable]
        [/filter_condition]
        [set_variable]
            name=turn_counter
            value=9
        [/set_variable]
    [/event]
    [event]
        name=turn refresh
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=9
            [/variable]
        [/filter_condition]
        [set_variable]
            name=turn_counter
            value=10
        [/set_variable]
    [/event]

    [event]
        name=new turn
        first_time_only=yes
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=10
            [/variable]
        [/filter_condition]

        {PLAY_SOUND "rumble.ogg"}

        [terrain]
            x=7,8,8,6,7
            y=37,36,37,40,40
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=5,6,6,7,8
            y=45,44,46,47,47
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=7,7,10,11,10,6,9
            y=23,22,22,25,26,29,29
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=25,27,21,22,20
            y=30,30,26,21,22
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=8,9,15,16,12,13
            y=13,14,13,13,7,7
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        {KILL_UNITS_ON_LAVA}
        [set_variable]
            name=turn_counter
            value=11
        [/set_variable]
    [/event]

    [event]
        name=turn refresh
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=11
            [/variable]
        [/filter_condition]
        [set_variable]
            name=turn_counter
            value=12
        [/set_variable]
    [/event]

    [event]
        name=new turn
        first_time_only=yes
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=12
            [/variable]
        [/filter_condition]

        {PLAY_SOUND "rumble.ogg"}

        [terrain]
            x=9,7,8,10
            y=37,41,41,37
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=6,9-12,13
            y=43,48,49
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=5,6,9,10,8,9,11,11,12,10,6,7
            y=31,30,30,29,27,28,26,28,24,21,21,21
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=28,28,26,24,21,22,22,19,19,19,18,22,23
            y=30,31,30,30,29,29,27,25,26,22,22,20,21
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=7,8,13,11,17,11,12
            y=13,14,13,14,9,7,6
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        {KILL_UNITS_ON_LAVA}
        [set_variable]
            name=turn_counter
            value=13
        [/set_variable]
        [set_variable]
            name=new_spawns
            value=1
        [/set_variable]
    [/event]

    [event]
        name=turn refresh
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=13
            [/variable]
        [/filter_condition]
        [set_variable]
            name=turn_counter
            value=14
        [/set_variable]
    [/event]

    [event]
        name=new turn
        first_time_only=yes
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=14
            [/variable]
        [/filter_condition]

        {PLAY_SOUND "rumble.ogg"}

        [terrain]
            x=7,9,10,11,11
            y=42-43,42,41,42,37
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=7,8
            y=38-39,39-40
            terrain=Ql
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=13-14,15
            y=50,51
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=4,5,11,11,12,12-13,11,12,13,8,8,6,7
            y=31,32,30,31,28,26,23,23,24,22,20,20,21
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=27,27,23,21,20,21,19,20,18,17,21,22,24,30
            y=32,33,31,30,28,27,26,27,25,23,22,19,20,21
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=5-6,7-8,10,12,12,16,17,19,19,14,15,10
            y=13,15,14,14,15,14,14,11,12,6-7,7,7
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        {KILL_UNITS_ON_LAVA}
        [set_variable]
            name=turn_counter
            value=15
        [/set_variable]
    [/event]

    [event]
        name=turn refresh
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=15
            [/variable]
        [/filter_condition]
        [set_variable]
            name=turn_counter
            value=16
        [/set_variable]
    [/event]
    [event]
        name=new turn
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=16
            [/variable]
        [/filter_condition]
        [set_variable]
            name=turn_counter
            value=17
        [/set_variable]
    [/event]
    [event]
        name=turn refresh
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=17
            [/variable]
        [/filter_condition]
        [set_variable]
            name=turn_counter
            value=18
        [/set_variable]
    [/event]

    [event]
        name=new turn
        first_time_only=yes
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=18
            [/variable]
        [/filter_condition]

        {PLAY_SOUND "rumble.ogg"}

        [terrain]
            x=11-12,12,12-13,8,6
            y=36,35,41-42,42,45
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=8,9,10,9-10
            y=38,41,40,38
            terrain=Ql
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=16,15,14,15,14
            y=51,52,52,53,53
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=2-3,3,6,6,7-8,12,12,13,13,14,14,13,11,11,10,7,8,4
            y=31,32,32,33,30,29,31,29,28,26,23,23,24,21,20,20,19,20
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=26,28,26,23,23,25,22,23,19,20,19,18,17,18,18,17,21,23,25,29,30,31
            y=33,33,32,30,32,28,25,27,29,30,28,27,27,26,24,24,24,19,20,21,20,22
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=3,4,5,7,8-9,11-12,14,15,16,13,19,20,17,16,15,15
            y=13,12,14,14,16,16,13,15,15,16,13,12,12,7-8,6,5
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        {KILL_UNITS_ON_LAVA}

        [message]
            speaker=Esther
            message= _ "We have to keep moving! We can't get caught here, or else the lava's going to kill everyone!"
        [/message]

        [set_variable]
            name=turn_counter
            value=19
        [/set_variable]
    [/event]

    [event]
        name=turn refresh
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=19
            [/variable]
        [/filter_condition]
        [set_variable]
            name=turn_counter
            value=20
        [/set_variable]
    [/event]

    [event]
        name=new turn
        first_time_only=yes
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=20
            [/variable]
        [/filter_condition]

        {PLAY_SOUND "rumble.ogg"}

        [terrain]
            x=13,14,14,15,14,15,6
            y=36,35,36,36,41,42,41
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=9,9,11,11-12,11
            y=39,40,38,40,41
            terrain=Ql
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=14,15,11-13,12,10
            y=54-56,57,53,52,52
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=1-2,6,5,8,11,13,13,13,14,15,14,10,14,15,12,12,9,9,6,3-4,12
            y=30,34,35,29,29,32,33,30,29,30,27,23,25,26,21,22,19,20,19,19,25
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=26,27,27,22,24,22,21,18,19,20,23,20,17,17,18,32,33,31,28,26,23,16,16
            y=34,34,35,32,32,31,32,31,31,29,26,24,25,28,28,22,23,21,20,19,18,22,23
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=3-4,4,6,5-6,8-9,10,14,12,17,11,21,14,15,18
            y=14,13,15,16,17,15,15,17,16,15,13,4,4,9
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        {KILL_UNITS_ON_LAVA}
        [set_variable]
            name=turn_counter
            value=21
        [/set_variable]
    [/event]

    [event]
        name=turn refresh
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=21
            [/variable]
        [/filter_condition]
        [set_variable]
            name=turn_counter
            value=22
        [/set_variable]
    [/event]

    [event]
        name=new turn
        first_time_only=yes
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=22
            [/variable]
        [/filter_condition]

        {PLAY_SOUND "rumble.ogg"}

        [terrain]
            x=15,16,16,15,16,4,3
            y=37,36,37,41,41,45,46
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=10,11,12,13,14,13,14
            y=39,39,37,37,37,40,40
            terrain=Ql
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=15,15,16,16,6-9
            y=58,59,59,60,53
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=0,13,14,6-7,12,13,12,12,15,14,14,14,15,12,13,11,13,14,12,13,7,8,11
            y=29,34,33,35,30,31,32,34,33,30,31,28,29,27,27,22,25,24,20,20,19,18,20
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=27-28,27,25,22,21,21,23,18,19,18,17,18,17,20,21,29,30,27,26,24,15
            y=36-37,31,33,30,31,33,33,30,30,29,31,32,29,27,28,30,29,20,18,18,22
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=4-5,4,5,7,10,12,14,15,21,22,18,17,9,8,13,14
            y=15,17,17,16,16,13,16,16,14,13,11,8,7,6,4,3
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        {KILL_UNITS_ON_LAVA}
        [set_variable]
            name=turn_counter
            value=23
        [/set_variable]
    [/event]

    [event]
        name=turn refresh
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=23
            [/variable]
        [/filter_condition]
        [set_variable]
            name=turn_counter
            value=24
        [/set_variable]
    [/event]

    [event]
        name=new turn
        first_time_only=yes
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=24
            [/variable]
        [/filter_condition]

        {PLAY_SOUND "rumble.ogg"}

        [terrain]
            x=15,16,16,15,16,4,3
            y=37,36,37,41,41,45,46
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=10,11,12,13,14,13,14
            y=39,39,37,37,37,40,40
            terrain=Ql
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=15,15,16,16,6-9
            y=58,59,59,60,53
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=0,13,14,6-7,12,13,12,12,15,14,14,14,15,12,13,11,13,14,12,13,7,8,11
            y=29,34,33,35,30,31,32,34,33,30,31,28,29,27,27,22,25,24,20,20,19,18,20
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=27-28,27,25,22,21,21,23,18,19,18,17,18,17,20,21,29,30,27,26,24,15
            y=36-37,31,33,30,31,33,33,30,30,29,31,32,29,27,28,30,29,20,18,18,22
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=4-5,4,5,7,10,12,14,15,21,22,18,17,9,8,13,14
            y=15,17,17,16,16,13,16,16,14,13,11,8,7,6,4,3
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        {KILL_UNITS_ON_LAVA}

        [message]
            speaker=Esther
            message= _ "Are you still okay?"
        [/message]
        [message]
            speaker=Yumi
            message= _ "Just splendid."
        [/message]
        [message]
            speaker=Esther
            message= _ "Okay, well hang on and I'll get us out of here..."
        [/message]

        [set_variable]
            name=turn_counter
            value=25
        [/set_variable]
    [/event]

    [event]
        name=moveto
        first_time_only=yes
        [filter]
            x=4-21
            y=19-24
            side=1
        [/filter]
        {PLAY_SOUND "thunder1.wav"}

        [scroll_to]
            x,y=13,12
        [/scroll_to]

        [lift_fog]
            [filter_side]
                side=1
            [/filter_side]
            x=10-16
            y=10-12
            multiturn=no
        [/lift_fog]

        {DELAY 1500}

        # this may be a bit excessive...
        {SPAWN_ID ("Demon Zephyr") 2 11 11 ("pursuer1") ("male")}
        {SPAWN_ID ("Demon Windlasher") 2 13 10 ("pursuer2") ("female")}
        {SPAWN_ID ("Demon Zephyr") 2 15 11 ("pursuer3") ("male")}

        [message]
            speaker=pursuer2
            message= _ "Block their path forward! Hold them there until the lava buries them all!"
        [/message]
        [message]
            speaker=Esther
            message= _ "Uh oh. Stay close, everyone! Don't get caught alone!"
        [/message]
    [/event]

    [event]
        name=last breath
        first_time_only=yes
        [filter]
            id=pursuer1
        [/filter]

        [message]
            speaker=unit
            message= _ "Ugh- we... must... stop... them..."
        [/message]
    [/event]

    [event]
        name=last breath
        first_time_only=yes
        [filter]
            id=pursuer2
        [/filter]

        [message]
            speaker=Esther
            message= _ "Who sent you? Why are you chasing us?"
        [/message]
        [message]
            speaker=unit
            message= _ "I'm not going to tell you anything."
        [/message]

        {FLASH_RED_EXTREME ({DELAY 250})}

        [message]
            speaker=Esther
            message= _ "Talk!"
        [/message]
        [message]
            speaker=unit
            message= _ "(<i>eyes roll back in head</i>)"
        [/message]
        [message]
            speaker=Yumi
            message= _ "Just kill her... she's not worth the effort."
        [/message]
    [/event]

    [event]
        name=last breath
        first_time_only=yes
        [filter]
            id=pursuer3
        [/filter]

        [message]
            speaker=unit
            message= _ "Fools, you'll all be- ack!"
        [/message]
        [message]
            speaker=Yumi
            message= _ "Just die already."
        [/message]
    [/event]

    [event]
        name=turn refresh
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=25
            [/variable]
        [/filter_condition]
        [set_variable]
            name=turn_counter
            value=26
        [/set_variable]
    [/event]

    [event]
        name=new turn
        first_time_only=yes
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=26
            [/variable]
        [/filter_condition]

        {PLAY_SOUND "rumble.ogg"}

        [terrain]
            x=16-17,1-2,0,2-3,7,5,2-3,4,14
            y=38-40,45,44,38,36,54,54,53,51
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=15,12,14,12-13
            y=38-40,39,39,38
            terrain=Ql
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=0,0,1,14,15,16,17,15,11,10,5,2-3
            y=30,31,31,32,32,29,30,31,27,28,20,18
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=29,30,26,29,31,22,24,25,19,20,19,33,25,23,27
            y=38,38,37,31,29,26,31,31,23,31,32,22,19,20,18
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=6,4-5,13,15,18,9,10,11,10,21,14,15
            y=14,18,14,14,12,18,17,17,19,15,2,3
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        {KILL_UNITS_ON_LAVA}
        [set_variable]
            name=turn_counter
            value=27
        [/set_variable]
    [/event]

    [event]
        name=turn refresh
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=27
            [/variable]
        [/filter_condition]
        [set_variable]
            name=turn_counter
            value=28
        [/set_variable]
    [/event]

    [event]
        name=new turn
        first_time_only=yes
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=28
            [/variable]
        [/filter_condition]

        {PLAY_SOUND "rumble.ogg"}

        [terrain]
            x=0,1,12,13
            y=54-56,55-56,49,51
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=13,14
            y=39,38
            terrain=Ql
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=2-3,9,10,13,16,16,3,5,8
            y=37,36,36,35,30,31,20,19,21
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=30,32,28,25,26,25,25,31,31,28,29,27,28,33,33,18,23,17,13,15,16,16
            y=30,28,32,32,31,37,38,38,39,35,39,17,17,21,20,23,17,26,21,21,27,28
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=7,9,13,23,23,20,13,14,16
            y=17,15,15,13,14,13,2,1,3
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        {KILL_UNITS_ON_LAVA}
        [set_variable]
            name=turn_counter
            value=29
        [/set_variable]
    [/event]

    [event]
        name=turn refresh
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=29
            [/variable]
        [/filter_condition]
        [set_variable]
            name=turn_counter
            value=30
        [/set_variable]
    [/event]

    [event]
        name=new turn
        first_time_only=yes
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=30
            [/variable]
        [/filter_condition]

        {PLAY_SOUND "rumble.ogg"}

        [terrain]
            x=12,13,12,11,11,10,4,8,14,15,15,16,16
            y=50,52,33,32,35,35,36,35,34,34,35,32,33
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=24,24,24,25,32,33,32,33,33,32,32,19,20,15,15,13,16,16,27,28,22,26
            y=36,37,38,39,37,37,39,28,29,20,21,24,23,27,28,22,26,24,16,15,17,17
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=9,9,10-11,11,6-7,15,15,18,14,20,24,24,24,16,16,14,13,13
            y=22,21,18,19,18,20,19,16,14,15,14,12,11,6,5,0,0,3
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        {KILL_UNITS_ON_LAVA}
        [set_variable]
            name=turn_counter
            value=31
        [/set_variable]

    [/event]

    [event]
        name=moveto
        first_time_only=yes
        [filter]
            x=16-22
            y=12-18
            side=1
        [/filter]


        {PLAY_SOUND "thunder1.wav"}
        [scroll_to]
            x,y=13,12
        [/scroll_to]

        [lift_fog]
            [filter_side]
                side=1
            [/filter_side]
            x=10-16
            y=10-12
            multiturn=no
        [/lift_fog]

        {SPAWN_ID ("Demon Zephyr") 2 11 11 ("pursuer4") ("male")}
        {SPAWN_ID ("Demon Windlasher") 2 13 10 ("pursuer5") ("female")}
        {SPAWN_ID ("Demon Zephyr") 2 15 11 ("pursuer6") ("male")}

        #ifdef HARD
            {SPAWN ("Blood Imp") 3 23 15}
            {SPAWN ("Blood Imp") 3 23 17}
            {SPAWN ("Blood Imp") 3 26 16}
            {SPAWN ("Blood Imp") 3 24 13}
            {SPAWN ("Blood Imp") 3 27 14}
        #endif
        #ifdef NORMAL
            {SPAWN ("Blood Imp") 3 23 15}
            {SPAWN ("Blood Imp") 3 26 16}
        #endif
        #ifdef EASY
            {SPAWN ("Blood Imp") 3 23 15}
        #endif


        [message]
            speaker=pursuer6
            message= _ "Advance! Leave none alive!"
        [/message]
        [message]
            speaker=Yumi
            message= _ "I don't think we can make it..."
        [/message]
        [message]
            speaker=Esther
            message= _ "We can. Just don't look back and fight only when you have to."
        [/message]
        [message]
            speaker=Yumi
            message= _ "But they're so strong..."
        [/message]
        [message]
            speaker=Esther
            message= _ "So are you. You can do it. Trust yourself."
        [/message]
        [message]
            speaker=Yumi
            message= _ "(<i>tilts head</i>)"
        [/message]
        [message]
            speaker=Esther
            message= _ "Right, scratch that. Stay close to me and avoid fighting if you can. I'll try to protect you and get us out of here. Trust me, Yumi."
        [/message]
        [message]
            speaker=Yumi
            message= _ "I-... not like I have a choice."
        [/message]
    [/event]

    [event]
        name=turn refresh
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=31
            [/variable]
        [/filter_condition]
        [set_variable]
            name=turn_counter
            value=32
        [/set_variable]
    [/event]

    [event]
        name=new turn
        first_time_only=yes
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=32
            [/variable]
        [/filter_condition]

        {PLAY_SOUND "rumble.ogg"}

        [terrain]
            x=4,9,10,10,17,20,23,23,23,22,25,32,33,33,33,32,33,29
            y=35,35,30,31,32,32,34,35,37,36,40,40,40,39,38,29,30,40
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=24,16,15,15,15,14,16,12,13,14,26,27,27,29,25,29,29,22,24,25,25
            y=19,25,25,24,23,22,18,19,17,18,15,15,19,20,17,15,16,15,10,11,12
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=12,13,16,17,12,11,15,6
            y=0,1,4,7,1,2,0,17
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]
        {KILL_UNITS_ON_LAVA}
        [set_variable]
            name=turn_counter
            value=33
        [/set_variable]
    [/event]

    [event]
        name=moveto
        first_time_only=yes
        [filter]
            x=23-29
            y=12-18
            side=1
        [/filter]

        [scroll_to]
            x,y=28,13
        [/scroll_to]
        {SPAWN_ID ("Demon Stromguarde") 4 27 13 ("lord1") ("male")}
        {SPAWN_ID ("Demon Stromguarde") 4 28 13 ("lord2") ("male")}
        {SPAWN_ID ("Demon Stromguarde") 4 29 13 ("lord3") ("male")}

        [object]
            [filter]
                id=lord1
            [/filter]
            silent=yes
            [effect]
                apply_to=movement_costs
                replace=yes
                [movement_costs]
                    unwalkable=1
                [/movement_costs]
            [/effect]
        [/object]

        [message]
            speaker=lord3
            message= _ "By the order of Lady Uria, Guardian of Ethea, stand down!"
        [/message]
        [message]
            speaker=lord1
            message= _ "Fools! What were you thinking, coming to Irdya and attacking the faerie? If not for our mistress's mercy, we would be your executioners. Even as it is..."
        [/message]
        [message]
            speaker=narrator
            message= _ "(<i>silence</i>)"
        [/message]
        [message]
            speaker=lord2
            message= _ "Have you all nothing to say?"
        [/message]
        [message]
            speaker=narrator
            message= _ "(<i>silence</i>)"
        [/message]
        [message]
            speaker=Esther
            message= _ "Umm, hello. Are you here to help us?"
        [/message]
        [message]
            speaker=lord1
            message= _ "Greetings. Lady Uria sends her blessings in Lady Xia'el's absence. We are here to maintain order."
        [/message]
        [message]
            speaker=Yumi
            message= _ "<i>Xia'el's absence? What is she doing...</i>"
        [/message]
        [message]
            speaker=Esther
            message= _ "Yes, well, it seems like your warriors are being commanded by someone to attack us. When we fought them earlier, there was something not quite right about their eyes, and they didn't respond at all when I tried to talk to them."
        [/message]
        [message]
            speaker=lord3
            message= _ "So it seems. Lady Uria has ordered us to investigate this issue and to aid you in your escape north. Advance quickly, before the lava blocks your path."
        [/message]
    [/event]

    [event]
        name=last breath
        first_time_only=no
        [filter]
            id=lord1
        [/filter]

        [heal_unit]
            [filter]
                id=lord1
            [/filter]
            amount=full
        [/heal_unit]
    [/event]
    [event]
        name=last breath
        first_time_only=no
        [filter]
            id=lord2
        [/filter]

        [heal_unit]
            [filter]
                id=lord2
            [/filter]
            amount=full
        [/heal_unit]
    [/event]
    [event]
        name=last breath
        first_time_only=no
        [filter]
            id=lord3
        [/filter]

        [heal_unit]
            [filter]
                id=lord3
            [/filter]
            amount=full
        [/heal_unit]
    [/event]

    [event]
        name=turn refresh
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=33
            [/variable]
        [/filter_condition]
        [set_variable]
            name=turn_counter
            value=34
        [/set_variable]
    [/event]

    [event]
        name=new turn
        first_time_only=yes
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=34
            [/variable]
        [/filter_condition]

        {PLAY_SOUND "rumble.ogg"}

        [terrain]
            x=9,9,24,23,22,22,18,16,21,21,32,33,30,31,26,26,28,29
            y=31,32,35,36,33,34,33,34,36,37,38,41,39,30,36,35,40,41
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=14,14,14,28,18,19,13,12,17,21,25,26,23,24,30,31,24,23
            y=19,20,21,19,13,14,19,18,18,17,18,16,15,15,15,15,13,10
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=17,18,18,17,17,19,19,21,29,30,31,29,16
            y=37,37,36,33,36,34,35,34,42,42,43,33,17
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=23,24,28,29,24,13,14,15,20
            y=22,21,16,17,17,18,17,18,14
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=9,12
            y=3,2
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]
        
        [terrain]
            x=9,10,8,11,15,16
            y=2,2,2,3,1,0
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        {KILL_UNITS_ON_LAVA}
        [set_variable]
            name=turn_counter
            value=35
        [/set_variable]
    [/event]

    [event]
        name=turn refresh
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=35
            [/variable]
        [/filter_condition]
        [set_variable]
            name=turn_counter
            value=36
        [/set_variable]
    [/event]
    
    [event]
        name=new turn
        first_time_only=yes
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=36
            [/variable]
        [/filter_condition]

        {PLAY_SOUND "rumble.ogg"}

        [terrain]
            x=19,20,16,17,22,19,19,23,22,32,33,31
            y=33,33,35,35,35,37,38,39,38,43,44,44
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=31,32,29,25,26,15,16,17,18,22,20,16,17
            y=16,15,14,13,10,17,16,17,18,14,17,19,19
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=10,12
            y=3,3
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        {KILL_UNITS_ON_LAVA}
        [set_variable]
            name=turn_counter
            value=37
        [/set_variable]
    [/event]

    [event]
        name=turn refresh
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=37
            [/variable]
        [/filter_condition]
        [set_variable]
            name=turn_counter
            value=38
        [/set_variable]
    [/event]

    [event]
        name=new turn
        first_time_only=yes
        [filter_condition]
            [variable]
                name=turn_counter
                numerical_equals=38
            [/variable]
        [/filter_condition]

        {PLAY_SOUND "rumble.ogg"}

        [terrain]
            x=17,18,18,21,20,21,20,32,33,31,22,23,22
            y=34,34,35,35,34,38,37,44,45,45,39,40,40
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=31,32,31,32,30,26,28,18,19,19,20,21
            y=14,13,17,16,16,14,14,17,17,16,16,16
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=32,33,33,33,24,24,25,18,18,21,20,20,21,18,20,22,23,22
            y=45,46,43,42,39,40,41,39,40,40,40,39,39,38,36,37,41,41
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=30,30,33,27,22,23,24,25,26,18
            y=17,14,17,14,16,16,16,16,11,19
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=24,19,19,20,23,19,20
            y=41,39,40,38,38,36,35
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [terrain]
            x=21,22,25,25
            y=18,18,14,15
            terrain=Qlf
        [/terrain]
        [redraw][/redraw]

        [message]
            speaker=Esther
            message= _ "I think it's finally stopping."
        [/message]
        
        {KILL_UNITS_ON_LAVA}
    [/event]

    [event]
        name=moveto
        [filter]
            x=25-32
            y=1-4
            id=Yumi,Esther
        [/filter]

        {CLEAR_VARIABLE turn_counter}
        {CLEAR_VARIABLE new_spawns}

        [message]
            speaker=Yumi
            message= _ "Oh my god."
        [/message]
        [message]
            speaker=Yumi
            message= _ "(<i>breathes</i>)"
        [/message]
        [message]
            speaker=Yumi
            message= _ "Fresh air..."
        [/message]
        [message]
            speaker=Esther
            message= _ "(<i>laughs</i>) Poor Yumi. The heat really got to you, huh."
        [/message]
        [message]
            speaker=Yumi
            message= _ "Lava's more your thing."
        [/message]
        [message]
            speaker=Esther
            message= _ "Actually it still hurts even me if I touch it. Even though, you know-"
        [/message]
        [message]
            speaker=Yumi
            message= _ "(<i>whispers</i>) Shush! Do you want everyone to know that we're... we're different?"
        [/message]
        [message]
            speaker=Esther
            message= _ "(<i>whispers</i>) I don't see why you're so nervous about that. It's not a big deal-"
        [/message]
        [message]
            speaker=Yumi
            message= _ "(<i>whispers</i>) It is!"
        [/message]
        [message]
            speaker=Esther
            message= _ "(<i>whispers</i>) Aren't you a bit paranoid?"
        [/message]
        [message]
            speaker=Yumi
            message= _ "(<i>sulks</i>)"
        [/message]
        [message]
            speaker=Esther
            message= _ "(<i>whispers</i>) Come on, you know it's true."
        [/message]
        [message]
            speaker=Yumi
            message= _ "(<i>frowns</i>)"
        [/message]
        [message]
            speaker=Esther
            message= _ "Aww, don't be mad at me. I'm just concerned about you. You always seem so on edge."
        [/message]
        [message]
            speaker=Yumi
            message= _ "Don't be. I'm fine."
        [/message]
        [message]
            speaker=Esther
            message= _ "I'm not sure about that."
        [/message]
        [message]
            speaker=Yumi
            message= _ "I really am."
        [/message]
        [message]
            speaker=Esther
            message= _ "I know you say that, but..."
        [/message]
        [message]
            speaker=Yumi
            message= _ "Please, Esther..."
        [/message]
        [message]
            speaker=Esther
            message= _ "Fine, fine, I'll leave you alone for now. But seriously, you should try to open up sometimes, okay?"
        [/message]
        [message]
            speaker=Yumi
            message= _ "I- I'll try."
        [/message]

        # set variables for next scenario
        [set_variable]
            name=lady_of_the_lake
            value=0
        [/set_variable]
        [set_variable]
            name=woodland_dreams
            value=0
        [/set_variable]
        [set_variable]
            name=blue_moon
            value=0
        [/set_variable]
        [set_variable]
            name=white_city
            value=0
        [/set_variable]
        [set_variable]
            name=black_cauldron
            value=0
        [/set_variable]
        [set_variable]
            name=glacial_shrine
            value=0
        [/set_variable]
        [set_variable]
            name=prev_scenario
            value="none"
        [/set_variable]

        [endlevel]
            result=victory
            bonus=yes
            {NEW_GOLD_CARRYOVER 40}
        [/endlevel]
    [/event]

    [event]
        name=time over

        [message]
            speaker=Yumi
            message= _ "Ugh, we're going to be buried under all this lava..."
        [/message]
        {CLEAR_VARIABLE turn_counter}

        [endlevel]
            result=defeat
        [/endlevel]
    [/event]
[/scenario]